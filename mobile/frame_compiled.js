var buildNumber=203;var buildDate="20151008 07:28";var DefaultFrame=function(){this.control_layouts={};this.ready=!1;this.options={};this.colorGroups={};this.sidebarItems={};this.visibleSidebarItems={};this.windows={};this.transcripts={};this.drawNavData={};this.slideStatus={};this.currentControlLayout={};this.currentControlEnabled={};this.currentWindowControlLayout={};this.currentWindowControlEnabled={};this.hasLinksRight=this.hasLinksLeft=!1;this.defaultControlLayout=null;this.hasBottomBar=!1;this.controlOptions={};this.customTabCount=0;this.frameScale=
1;this.buttonTouchMoved=!1;this.options.enableresultsicons=!0;this.seekColor="#fff";this.frameBounds=new ppRect(0,0,0,0);this.windowBounds=new ppRect(0,0,0,0);this.slideBounds=new ppRect(0,0,0,0)};DefaultFrame.prototype=new Frame;
var FrameKit={controlMap:{},presenterVisible:!1,logoVisible:!1,NAV_WIDTH:220,LOGO_WIDTH:200,iconSrc:"data:image/png;base64,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",isPortrait:function(){var a=
!1;player.isIOS&&(!player.isIOSlt8||!player.isCrossDomainFrame)?(a=player.isCrossDomainFrame?window.orientation:top.window.orientation,a=a/180==parseInt(a/180)):(a=DefaultFrame.getWindowSize(!0),a=a.width<a.height);return a}};
DefaultFrame.prototype.createFrame=function(a){var b=this;b.xml=a;this.defaultLayoutName=$(a).find("bwFrame").attr("default_layout");this.textdirection=$(a).find("bwFrame").attr("textdirection");this.rtl="rtl"==this.textdirection;this.outputtype=$(a).find("bwFrame").attr("outputtype");this.presenters={};$(a).children("bwFrame").children("presenters").children("presenter").each(function(a,d){var e=new Presenter;e.loadFromXML(d);b.presenters[e.id]=e});this.parseColorSchemes(a);this.parseOptionGroups(a);
this.applyColorSchemes();this.applyRTL();$(a).find("control_layouts").children("control_layout").each(function(a,d){var e={controls:{}},f=$(d).attr("name");$(d).children("control").each(function(a,c){e.controls[$(c).attr("name")]="true"==$(c).attr("enabled")});b.control_layouts[f]=e;if(!b.defaultControlLayout)b.defaultControlLayout=e});Frame.initControlMaps();Frame.navLinks=this.parseNavLinks($(a).children().children("nav_data").children("outline"));this.initComponents();this.initOrientation();Frame.current.bind();
player.showControls&&$("#controls").show();player.isMobile||$(window).bind("resize",function(){b.updateFrame();b.raiseBoundsChanged()});this.ready=!0;return $("#slidecontainer")};DefaultFrame.prototype.initComponents=function(){this.applyColorSchemes();this.applyRTL();Frame.initControlMaps();this.updateMenuData();this.progressBar=new ProgressBar(null,$(".progress-container"),!0)};
DefaultFrame.prototype.updateMenuData=function(a,b){if(Frame.navLinks&&this.slideList){if(a)this.drawNavData=a;if(b)this.slideStatus=b;this.slideList.contentRef.empty();this.slideList.tree=new SlideListNode;this.slideList.build(Frame.navLinks,null,null,null,this.slideList.tree)}};
Frame.initControlMaps=function(){FrameKit.controlMap={previous:$(".control-previous"),next:$(".control-next"),finish:$(".control-finish"),submit:$(".control-submit"),submitall:$(".control-submitall"),volume:$(".control-volume"),seekbar:$(".control-progress,.progress-container"),replay:$(".control-restart"),pauseplay:$(".control-pauseplay"),resources:$(".tab.resources"),glossary:$(".tab.glossary"),transcript:$(".tab.transcript"),outline:$(".tab.outline"),close_btn:$("#NOT_IMPLEMENTED-close_btn"),search:$("#TODO-resources")};
Frame.windowControlMap={previous:$(".window .control-previous"),next:$(".window .control-next"),finish:$(".window .control-finish"),submit:$(".window .control-submit"),submitall:$(".window .control-submitall"),close_btn:$(".window .control-close_btn")}};
DefaultFrame.prototype.parseNavLinks=function(a,b){var c=this,d=[];$(a).children("links").children().each(function(a,f){var g=f.tagName,h=$(f).attr("type");switch(g){case "slidelink":"action"==h?d.push(c.parseActionLink(f,b)):d.push(c.parseSlideLink(f,b));break;case "slidedrawref":d.push(c.parseSlideDraw(f))}});return d};
DefaultFrame.prototype.parseSlideLink=function(a,b){var c={slideid:$(a).attr("slideid"),displaytext:$(a).attr("displaytext"),expand:"true"==$(a).attr("expand"),parent:b};if(0<$(a).children("links").length)c.links=this.parseNavLinks(a,c);return c};
DefaultFrame.prototype.parseActionLink=function(a,b){var c={actionlinkid:$(a).attr("slideid"),displaytext:$(a).attr("displaytext"),expand:!1,parent:b};if(0<$(a).children("links").length)c.links=this.parseNavLinks(a,c);var d=story.parseObjref(c.actionlinkid).target;story.children[c.actionlinkid]&&(d=story.children[c.actionlinkid]);d&&d.navLinks&&d.navLinks.push(c);return c};DefaultFrame.prototype.parseSlideDraw=function(a){return{drawid:$(a).attr("drawid")}};
DefaultFrame.prototype.setVisibility=function(a,b){b||a.hide()};DefaultFrame.prototype.parseOptionGroups=function(a){var b=this;$(a).children().children("control_options").children("optiongroups").children("optiongroup").each(function(a,d){var e=$(d).attr("name");b.parseOptions(d,e)});if(!b.options.title_enabled&&!b.options.sidebar_enabled&&!b.cant_hide_topbar)b.top_bar_hidden=!0;b.top_bar_hidden&&$(".top_bar").hide();a=$("#menu_tabs>.tab");0<=a.length&&a.first().click()};
DefaultFrame.prototype.parseOptions=function(a,b){var c=this;$(a).children("options").children().each(function(a,e){$(e).get(0);var f=$(e).attr("name"),g=$(e).attr("value"),h="true"==g;c.options[f]=g;if("true"==g||"false"==g)c.options[f]=h;switch(f){case "title_enabled":c.setVisibility($("#storytitle"),h);break;case "title_text":story.title=g;$("#storytitle_section").text(g);document.title=g;break;case "video_enabled":c.options.video_width=parseInt($(e).find("option[name='width']").attr("value"));
c.options.video_height=parseInt($(e).find("option[name='height']").attr("value"));break;case "logo_enabled":h&&($(".landscape_menu").removeClass("no_logo"),$(".logo_background").show());FrameKit.logoVisible=h;break;case "logo_url":c.logoRef=$("<img/>");if(0<$(e).find("property[name='width']").length){f=parseInt($(e).find("property[name='width']").attr("value"));parseInt($(e).find("property[name='height']").attr("value"));if(f>FrameKit.LOGO_WIDTH)f=FrameKit.LOGO_WIDTH;c.logoRef.css("width",f)}else c.logoRef.bind("load",
function(){c.logoRef.width()>FrameKit.LOGO_WIDTH?c.logoRef.css("width",FrameKit.LOGO_WIDTH):c.logoRef.css("width",c.logoRef.width());c.updateLayout()});$(e).attr("value")&&($(".logo_background>.logo_section").append(c.logoRef),$(".logo_background>.logo_section").append("<div class='menu_divider'/>"));c.logoSrc&&c.logoRef.attr("src",c.logoSrc);break;case "html5_logo_url":c.logoSrc=player.basepath+g;c.logoRef&&c.logoRef.attr("src",c.logoSrc);break;case "sidebar_enabled":player.forceMenu||(c.setVisibility($(".control-menu"),
h),c.setVisibility($(".portrait_menu"),h),c.setVisibility($(".landscape_menu"),h));break;case "sidebarpos":$(".landscape_menu").addClass(g);break;case "tabs":c.customTabCount=0;$(e).children("listitems").children("listitem").each(function(a,b){var d=$(b).attr("name"),e="true"==$(b).attr("value"),f=$(b).attr("group");if(e){var g=function(a,b,d,e){c.addTopTab(a,b,d,e,n)};"sidebar"==f&&(g=function(a,b,d,e){c.addSideTab(a,b,d,e,n)},c.sidebarItems[d]=e);e=c.getTextLabel(d);switch(d){case "outline":"qm"==
c.outputtype&&(e=c.getTextLabel("question_list"),""==e&&(e=c.getTextLabel(d)));c.slideList=new SlideList;g(f,e,c.slideList.ref,d);break;case "glossary":c.glossaryPanel=new GlossaryPanel;c.glossaryPanel.loadFromXML($(c.xml).find("glossary_data").first());g(f,e,c.glossaryPanel.ref,d);break;case "resources":c.resourcesPanel=new ResourcesPanel;c.resourcesPanel.loadFromXML($(c.xml).find("resource_data").first());g(f,e,c.resourcesPanel.ref,d);break;case "transcript":c.transcriptPanel=new TranscriptPanel;
c.transcriptPanel.loadFromXML($(c.xml).find("transcript_data").first());g(f,e,c.transcriptPanel.ref,d);break;case "customlink":var e=$(b).find("property[name='title']").attr("value"),h=$(b).find("property[name='data']").attr("value"),n="true"==$(b).find("property[name='ignoreSlideLock']").attr("value");c.customTabCount++;g(f,e,h,d,n)}}});break;case "info_enabled":$(e).children("options").children('option[name="default"]').each(function(a,b){var d=$(b).attr("value");c.options.info_enabled_default=
d});h&&($(".landscape_menu").removeClass("no_logo"),$(".logo_background").show(),c.updatePresenter(c.options.info_enabled_default));break;case "wraplistitems":h&&$("#player").addClass("wraplistitems");break;case "seekbar":h?$(e).children("options").children('option[name="readonly"]').each(function(a,b){var d="true"==$(b).attr("value");c.readOnlySeekbar=d}):($(".player_controls").css("display","none!important"),$(".control-progress").css("display","none"));break;case "bottombar_enabled":if(c.setVisibility($(".bottom_bar"),
h),c.setVisibility($("#controls"),h),h)c.shouldHaveBottomBar=!0,c.hasBottomBar=!0}c.parseOptions(e,b)})};
DefaultFrame.prototype.addTopTab=function(a,b,c,d,e){var f=this;f.top_bar_hidden=!1;f.cant_hide_topbar=!0;if("customlink"==d)return f.addTopLink(a,b,c,d,e);var g=$('<div class="toptab tab '+d+'"><span class="label '+d+'">'+b+'</span><div class="menu_container"></div></div>');g.children(".menu_container").append(c);"linkright"==a?($("#toplinks_right").prepend(g),f.hasLinksRight=!0):($("#toplinks_left").append(g),f.hasLinksLeft=!0);this.formatTopTabs(a);a=player.isMobile?"touchend":"click";g.children("span").first().bind(a,
function(a){if(g.hasClass("active"))g.removeClass("active");else if(MouseEvents.processHideables(a),$("#topbar .active").removeClass("active"),g.addClass("active"),!f.registeredTopBar)MouseEvents.addHideable(".toptab.active",".toptab .menu_container, #frameswitch",function(){$(".toptab.active").removeClass("active")}),f.registeredTopBar=!0;return!1})};
DefaultFrame.prototype.addSideTab=function(a,b,c,d){a=$('<li class="tab '+d+'"><span class="left label '+d+'">'+b+"</span></li>");$("#menu_tabs").append(a);$("#menu_container").append(c);var e=a.children("span").first();a.bind("click",function(){$("#topbar .active").removeClass("active");$("#menu_tabs .active").removeClass("active");$("#menu_container .active").removeClass("active");e.addClass("active");c.addClass("active");return!1})};
DefaultFrame.prototype.formatTopTabs=function(a){a="linkright"==a?"#toplinks_right":"#toplinks_left";this.colorGroups.base&&($(".toptab-separator").remove(),$(a).children(":visible").each(function(a,c){0!=a&&$(c).parent().append($("<div class='toptab-separator'></div>"),$(c))}))};
DefaultFrame.prototype.addTopLink=function(a,b,c,d,e){var f=$('<div class="toptab customlink"><span class="label '+d+'">'+b+"</span></div>");"linkright"==a?($("#toplinks_right").prepend(f),this.hasLinksRight=!0):($("#toplinks_left").append(f),this.hasLinksLeft=!0);this.formatTopTabs(a);e&&f.addClass("ignorelocked");f.children("span").first().bind("click",function(){(!f.hasClass("locked")||e)&&story.handleEvent("onobjectevent",c,null,!1,!1,!0);return!1})};
DefaultFrame.prototype.parseColorSchemes=function(a){var b=this;$(a).children().children("colorschemes").children("colorscheme").children("color_group").each(function(a,d){var e=$(d).attr("name");b.parseColorGroup(d,e)})};DefaultFrame.prototype.parseColorGroup=function(a,b){var c={};$(a).children("group_colors").children("color").each(function(a,b){var f=$(b).attr("name"),g=new Background;g.loadFromXML($(b),"fill");c[f]=g});this.colorGroups[b]=c};
DefaultFrame.prototype.applyRTL=function(){this.rtl&&($(document.body).addClass("rtl"),Frame.initControlMaps())};DefaultFrame.prototype.applyBackground=function(a,b,c,d){if(Frame.current.colorGroups[b]&&Frame.current.colorGroups[b][c]){var e=Frame.current.colorGroups[b][c].toCssString(),b=Frame.current.colorGroups[b][c].toColorString();a.add(d,"background-color",b);a.add(d,"background",e);a.add(d,"background",e.replace("-webkit","-moz"));a.add(d,"background",e.replace("-webkit","-ms"))}};
DefaultFrame.prototype.applyBorder=function(a,b,c,d){if(Frame.current.colorGroups[b]&&Frame.current.colorGroups[b][c])switch(b=Frame.current.colorGroups[b][c],b.backgroundType){case "fill":a.add(d,"border-color",b.stops[0].color)}};DefaultFrame.prototype.applyGlow=function(a,b,c,d){this.applyColor(a,b,c,d,"box-shadow"," 0px 0px 1px 1px")};
DefaultFrame.prototype.applyColor=function(a,b,c,d,e,f,g){if(Frame.current.colorGroups[b]&&Frame.current.colorGroups[b][c])switch(b=Frame.current.colorGroups[b][c],b.backgroundType){case "fill":b=b.toColorString(),g&&(b=g+b),f&&(b+=f),a.add(d,e,b)}};
DefaultFrame.prototype.applyColorSchemes=function(){if(!player.noframe&&!player.noframecolor&&($.each(story.children,function(a,b){"Window"==b.innerType&&-1==b.linkid.indexOf("StoryPopup")&&b.ref&&Frame.current.colorGroups.window&&Frame.current.colorGroups.window.bg&&setTimeout(function(){try{b.ref.css("background-color",Frame.current.colorGroups.window.bg.toCssString()),b.ref.css("color",Frame.current.colorGroups.window.text.toCssString()),b.ref.find("h1").css("color",Frame.current.colorGroups.window.text.toCssString()),
b.ref.css("border-color",Frame.current.colorGroups.window.divb.toCssString()),b.ref.find("hr").css("border-color",Frame.current.colorGroups.window.divb.toCssString())}catch(a){}},0)}),player.isHTML5)){var a=new CustomStyleSheet;this.applyBackground(a,"base","bg","#slidebg");this.applyBackground(a,"base","slide_bg","#framewrap,.bg");this.applyBackground(a,"base","slide_bg",".window.LightboxControlsWnd");this.applyBackground(a,"base","menu_shade",".landscape_menu");this.applyBorder(a,"base","border",
"#framewrap");this.applyBorder(a,"base","border",".landscape_menu");this.applyColor(a,"base","text","a,body","color");this.applyColor(a,"base","diva",".toptab-separator","border-left-color");this.applyColor(a,"base","divb",".toptab-separator","border-right-color");this.applyBackground(a,"button","btn_bg",".controlbar-button,.control-progress.compact");this.applyBorder(a,"button","btn_border",".controlbar-button,.control-progress.compact");this.applyGlow(a,"button","btn_glow",".controlbar-button,.control-progress.compact");
player.isMobile||(this.applyBackground(a,"button","btn_hover",".controlbar-button:hover"),this.applyBackground(a,"button","btn_bg",".controlbar-button.volume-open:hover"));this.applyBackground(a,"button","btn_down",".controlbar-button.right.pressed");this.applyBackground(a,"seekcontrol","seek_bg","#progressbar");this.seekColor=Frame.current.colorGroups.seekcontrol.seek_position.toColorString();this.seekBackgroundColor=Frame.current.colorGroups.seekcontrol.bg.toColorString();this.applyBorder(a,"seekcontrol",
"seek_border","#progressbar,.progress-bar");this.applyBackground(a,"seekcontrol","bg",".control-progress,.control-progress:hover");this.applyBorder(a,"seekcontrol","border",".control-progress");this.applyBackground(a,"volume","thumb_bg",".volume-handle");this.applyBackground(a,"volume","slider_bg",".volume-slider");this.applyBorder(a,"volume","thumb_border",".volume-handle");this.applyBorder(a,"volume","slider_border",".volume-slider");this.applyColor(a,"volume","thumb_inner",".volume-handle","-webkit-box-shadow",
" 0px 0px 1px 1px","inset ");this.applyColor(a,"volume","thumb_inner",".volume-handle","-moz-box-shadow"," 0px 0px 1px 1px","inset ");this.applyColor(a,"volume","thumb_inner",".volume-handle","-ms-box-shadow"," 0px 0px 1px 1px","inset ");this.applyColor(a,"volume","thumb_inner",".volume-handle","box-shadow"," 0px 0px 1px 1px","inset ");this.applyBackground(a,"menu","bg",".menu_container");this.applyColor(a,"listitem","text","ul.menu_list a","color");this.applyColor(a,"listitem","text","ul.slidelist li",
"color");this.applyColor(a,"listitem","text",".menu_container li a","color");this.applyColor(a,"listitem","viewed","ul.menu_list li.visited > a","color");this.applyColor(a,"listitem","viewed","ul.slidelist li.visited","color");player.isMobile||(this.applyBackground(a,"listitem","hover","li.has_children.open li>a:hover"),this.applyBackground(a,"listitem","hover","ul.slidelist li:hover"),this.applyColor(a,"listitem","text","ul.menu_list li.visited > a:hover","color"),this.applyColor(a,"listitem","text",
"ul.slidelist li.visited:hover","color"),this.applyBackground(a,"listitem","selected","ul.menu_list li.selected, ul.menu_list li.selected > a, ul.menu_list li.selected > a:hover"),this.applyBackground(a,"listitem","selected","ul.slidelist li.selected, ul.slidelist li.selected > a:hover"));this.applyColor(a,"listitem","lines","ul.menu_list>li","border-top-color");this.applyColor(a,"listitem","lines","ul.slidelist li.divider","border-bottom-color");this.applyColor(a,"listitem","selected_text","ul.menu_list li.selected > a",
"color");this.applyColor(a,"listitem","selected_text","ul.slidelist li.selected","color");this.applyColor(a,"listitem","text","ul.menu_list li.has_children > span","border-left-color");this.applyColor(a,"listitem","text","ul.menu_list li.has_children.open > span","border-top-color");this.applyColor(a,"listitem","text","ul.slidelist li>span","border-left-color");this.applyColor(a,"listitem","text","ul.slidelist li.open>span","border-top-color");this.applyBackground(a,"menu","bg","ul.menu_nav li span.active, .toptab.active>span");
this.applyColor(a,"tabs","text","ul.menu_nav li span","color");this.applyColor(a,"tabs","selected","ul.menu_nav li span.active, .toptab.active>span","color");this.applyBorder(a,"window","divb",".toptab.active>span,.toptab .menu_container");this.applyColor(a,"window","divb",".logo_background .menu_divider","border-bottom-color");this.applyBorder(a,"resource","separator",".resources_container hr");this.applyBorder(a,"transcript","div",".transcript_container hr");this.applyColor(a,"transcript","heading_text",
".transcript_title","color");this.applyColor(a,"menu","shadow",".toptab .menu_container","-webkit-box-shadow"," 0px 0px 20px");this.applyColor(a,"menu","shadow",".toptab .menu_container","-moz-box-shadow"," 0px 0px 20px");this.applyColor(a,"menu","shadow",".toptab .menu_container","-ms-box-shadow"," 0px 0px 20px");this.applyColor(a,"menu","shadow",".toptab .menu_container","box-shadow"," 0px 0px 20px");this.applyBackground(a,"glossary","bg",".glossary_section");this.applyBackground(a,"tabs","bg",
".glossary_section_header");player.isMobile||this.applyBackground(a,"glossary","hover",".glossary_section li:hover");this.applyBackground(a,"glossary","selected",".glossary_section li.active");this.applyColor(a,"glossary","selected",".glossary_section li.active","color");this.applyColor(a,"glossary","diva",".glossary_section_header, .glossary_section:first-child","border-bottom-color");this.applyColor(a,"glossary","divc",".glossary_section_header","border-top-color");this.applyColor(a,"glossary",
"text",".glossary_container li a","color");this.applyColor(a,"glossary","heading_text",".glossary_section .label","color");this.applyColor(a,"glossary","selected_text",".glossary_section li.active a","color");this.applyBackground(a,"glossary","selected",".glossary_section li.active");this.applyBackground(a,"logo","bg",".logo_background>.logo_section");this.applyBackground(a,"infopanel","bg",".logo_background>.presenter_section");this.applyBackground(a,"infopanel","bg",".logo_background>.presenter_video_section");
this.applyColor(a,"logo","shadow",".logo_background","box-shadow"," 0px 1px 0px 0px","");this.applyColor(a,"infopanel","name_text",".presenter_info .presenter_name","color");this.applyColor(a,"infopanel","title_text",".presenter_info .presenter_title","color");this.applyColor(a,"infopanel","link_text",".presenter_info a","color");this.applyColor(a,"infopanel","link_hover",".presenter_info a:hover","color");this.applyBackground(a,"infopanelpopup","bg",".presenter_detail");this.applyColor(a,"infopanelpopup",
"name_text",".presenter_detail .presenter_name","color");this.applyColor(a,"infopanelpopup","title_text",".presenter_detail .presenter_title","color");this.applyColor(a,"infopanelpopup","link_text",".presenter_detail a","color");this.applyColor(a,"infopanelpopup","link_hover",".presenter_detail a:hover","color");if(Frame.current.colorGroups.button&&Frame.current.colorGroups.button.btn_icon_color){var b=Frame.current.colorGroups.button.btn_text_shadow.stops[0],c=Frame.current.colorGroups.seekcontrol.btn_icon_color.stops[0],
d=Frame.current.colorGroups.seekcontrol.btn_icon_shadow.stops[0],e=Frame.current.colorGroups.seekcontrol.btn_icon_hover.stops[0];this.prepIconSprite(".controlbar-button .icon",Frame.current.colorGroups.button.btn_icon_color.stops[0],b,a);this.prepIconSprite(".control-progress .icon",c,d,a);player.isMobile||this.prepIconSprite(".control-progress .icon:hover",e,b,a);this.applyColor(a,"button","btn_icon_color",".controlbar-button .label","color");this.applyColor(a,"button","btn_text_shadow",".controlbar-button .label",
"text-shadow","","0px 1px 1px ")}a.add(".zoombuttoninner","background-image","url("+FrameKit.iconSrc+")");a.add("ul.slidelist li.correct:before","background-image","url("+FrameKit.iconSrc+")");a.add("ul.slidelist li.incorrect:before","background-image","url("+FrameKit.iconSrc+")");a.build()}};
DefaultFrame.prototype.applyColorDirect=function(a,b,c,d,e,f){if(Frame.current.colorGroups[a]&&Frame.current.colorGroups[a][b])switch(a=Frame.current.colorGroups[a][b],a.backgroundType){case "fill":a=a.toColorString(),f&&(a=f+a),e&&(a+=e),$(c).css(d,a)}};
DefaultFrame.prototype.applyBackgroundDirect=function(a,b,c){if(Frame.current.colorGroups&&Frame.current.colorGroups[a]&&Frame.current.colorGroups[a][b]){var d=Frame.current.colorGroups[a][b].toCssString(),a=Frame.current.colorGroups[a][b].toColorString();$(c).css("background-color",a);$(c).css("background",d)}};Frame.parseRGB=function(a){a=a.replace("#","");return[parseInt(a.substr(0,2),16),parseInt(a.substr(2,2),16),parseInt(a.substr(4,2),16)]};
DefaultFrame.prototype.prepIconSprite=function(a,b,c,d){var e=Frame.parseRGB(b.rawcolor),f=Frame.parseRGB(c.rawcolor);e.push(b.alpha);f.push(c.alpha);var g=new Image;$(g).bind("load",function(){var b=document.createElement("canvas");b.width=246;b.height=16;var c=b.getContext("2d");c.drawImage(g,0,0);if(c.getImageData){for(var i=c.getImageData(0,0,b.width,b.height),j=0;j<i.data.length-4;j+=4){var l=i.data[j];0!=i.data[j+3]&&(i.data[j]=e[0],i.data[j+1]=e[1],i.data[j+2]=e[2],i.data[j+3]=255-l)}c.clearRect(i,
0,0,b.width,b.height);c.putImageData(i,0,0);c.shadowColor="rgba("+f[0]+","+f[1]+","+f[2]+","+f[3]+")";c.shadowOffsetX=0;c.shadowOffsetY=1;c.shadowBlur=1;c.clearRect(i,0,0,b.width,b.height);c.drawImage(b,0,0);b=b.toDataURL("image/png");d&&d.add(a,"background-image","url("+b+")");d.build()}else d&&d.add(a,"background-image","url("+FrameKit.iconSrc+")")});g.src=FrameKit.iconSrc};
DefaultFrame.prototype.setWindowControlLayout=function(a,b){Frame.initControlMaps();var c=a==Frame.WINDOW_CURRENT?this.currentWindow:this.windows[a];c?this.setFrameLayout(b,Frame.windowControlMap,c):this.setFrameLayout(b)};
DefaultFrame.prototype.setFrameLayout=function(a,b,c){var d=void 0!=c,b=b||FrameKit.controlMap,e=!0,f=$(".control-container");c&&c.ref&&(f=c.ref.find(".control-container"));c&&!c.progressBar&&(f=$("<div/>"),e=!1);var g=this;g.currentLayoutName=a;c=g.control_layouts[a];if(!c)c=g.control_layouts[g.defaultLayoutName],g.currentLayoutName=g.defaultLayoutName;if(!c)c=g.defaultControlLayout;if(c){g.updateTextLabels();var h=0,k=!1,i=!1,j=!1,a=this.shouldHaveBottomBar;if(this.options.forceseekbar)c.controls.seekbar=
!0,c.controls.pauseplay=!0,c.controls.replay=!0;d?(g.currentWindowControlLayout=jQuery.extend({},c.controls),g.currentWindowControlEnabled=jQuery.extend({},c.controls)):(g.visibleSidebarItems={},g.currentControlLayout=jQuery.extend({},c.controls),g.currentControlEnabled=jQuery.extend({},c.controls));$.each(c.controls,function(a,c){var e=b[a];if(e)c?(e.show(),e.addClass("visible"),("previous"==a||"next"==a||"submit"==a||"submitall"==a||"finish"==a)&&h++,"volume"==a&&(k=!0),"seekbar"==a&&(i=!0),"pauseplay"==
a&&(j=!0)):(e.hide(),e.removeClass("visible"));else if("logo"==a)FrameKit.logoVisible=Frame.current.options.logo_enabled&&c;c&&g.sidebarItems[a]&&!d&&(g.visibleSidebarItems[a]=!0)});1!=player.width&&(this.updateLayout(!0),(player.isMobile||this.isPhone)&&this.updateFrame(!0));if(e){$("#controls .disabled").removeClass("disabled");this.resizeProgressBar(f,i,j,a);this.layoutMenuTabs();var l=17+7*h;$.each([".control-previous",".control-next",".control-submit",".control-submitall",".control-finish"],
function(a,b){var c=$(b);"block"==c.css("display")&&(l+=c.get(0).offsetWidth)});k&&(l+=40);e=this.availableWidth-l;f.find(".control-progress").css("width",e);this.progressWidthOuter=e;this.resizeProgressBar();!i&&j?(f.find("#progressbar,.icon.restart").hide(),f.find(".control-progress,.control-pauseplay").show(),f.find(".control-progress").css("width",16),f.find(".control-progress").addClass("compact")):f.find(".control-progress").removeClass("compact");i?$(".control-volume").css("margin-right","7px"):
$(".control-volume").css("margin-right",0);this.layoutMenuTabs();!k&&!i&&0==h&&(a=!1);this.hasBottomBar=a;this.updateLayout();0==$("#menu_tabs>.tab:visible>.active").length&&$("#menu_tabs>.tab:visible").first().click();this.formatTopTabs("linkleft");this.formatTopTabs("linkright")}}};
DefaultFrame.prototype.layoutMenuTabs=function(a){var a=a||7,b=$(".landscape_menu #menu_tabs>li>span:visible"),c=b.length;if(2<c){var d=FrameKit.NAV_WIDTH,e=0,f=[],g=0,h=0,k;$("ul.menu_nav li span").css("padding","0px "+a+"px");for(e=0;e<c;e++){k=b.eq(e);k.css("width","initial");var i=$("<div />").css({margin:0,padding:0});k.append(i);g=i.width();i.remove();f.push({tab:k,width:g});h+=g}d-=2*c*a;b=d-h;d/=c;if(0>b&&2<a)this.layoutMenuTabs(a-1);else{f.sort(function(a,b){return a.width>b.width?1:a.width<
b.width?-1:0});for(e=0;e<c;e++)k=f[e].tab,g=f[e].width,0<b?g+=2>=c?a:b/c:g<d?d+=(d-g)/(c-(e+1)):g=d,k.css("width",g)}}};DefaultFrame.prototype.resizeProgressBar=function(){var a=ProgressBar.getCurrentProgressBar();if(a){var b=a.ref.parent(),a=b.children(),b=b.parent().find(".control-progress .progress-container");this.progressWidth=this.progressWidthOuter-11;for(var c=0;c<a.length;c++)a[c]!=b[0]&&(this.progressWidth-=a[c].offsetWidth);b.css("width",this.progressWidth)}};
DefaultFrame.prototype.isSidebarVisible=function(){for(var a in this.visibleSidebarItems)return!0;return!1};DefaultFrame.prototype.initOrientation=function(){this.updateLayout()};DefaultFrame.prototype.updateFrame=function(a){1!=player.width&&this.updateLayout(a)};DefaultFrame.prototype.updateLayout=function(){this.updateFrameLayout();this.updatePlayerLayout();this.updateSidebarLayout();this.resizeProgressBar()};
DefaultFrame.prototype.updateSidebarLayout=function(){var a=$(".logo_background").height(),a=$(".logo_background").is(":visible")?a+8:0;navListHeight=this.navListHeight-a;$(".landscape_menu .menu_container").css("height",navListHeight+"px")};
DefaultFrame.prototype.updatePlayerLayout=function(){DefaultFrame.resizeSpinners();if(!player.noframe){var a=this.availableSlideWidth,b=0;Frame.current.top_bar_hidden?$("#topbar").addClass("empty"):this.options.title_enabled?($("#storytitle").removeClass("alone"),$(".toptab").removeClass("alone"),$(".toptab").removeClass("notitle"),$("#topbar").removeClass("empty"),!(0<$("#topbar>#toplinks_left .toptab:visible").length)&&this.hasLinksRight&&($("#storytitle").addClass("alone"),$(".toptab").addClass("alone")),
b+=20):($("#storytitle").removeClass("alone"),$(".toptab").removeClass("alone"),$("#topbar").removeClass("empty"),$(".toptab").addClass("notitle"),0==$("#topbar .toptab:visible").length&&$("#topbar").addClass("empty"));if(this.hasLinksLeft||this.hasLinksRight)b+=20;var c=this.options.logo_enabled&&FrameKit.logoVisible||FrameKit.presenterVisible,d=Frame.current.options.sidebar_enabled&&this.isSidebarVisible(),e=Frame.current.bottom_bar_hidden||!Frame.current.hasBottomBar?-9:41,f=d||c?240:0,g="left"==
Frame.current.options.sidebarpos?f:0,h=Frame.current.rtl&&"right"==Frame.current.options.sidebarpos?f:0,k=this.containerWidth,i=this.containerHeight;this.bottomBarOffset=e;k=k-f-20+2;e=i-b-e-20-7;this.availableWidth=k;this.availableHeight=e;this.availableSlideWidth=k;this.availableSlideHeight=e;var j="left"==Frame.current.options.sidebarpos?0:k+20,f="left"==Frame.current.options.sidebarpos?f+10:10,f=f-1;$(".landscape_menu").css("left",j);$(".contentpane>#controls").css("left",f);$(".contentpane>#controls").css("width",
k);$("#topbar").css("left",f);$("#topbar").css("width",k);$(".toptab .menu_container").css("height",parseInt(0.8*e));f=10;j=g+10-1;h=h+10-1;i=i-20+2;this.updateInfoPanel(this.updatePresenter());this.navListHeight=i-25;var l=(e-player.height)/2;if(0<l)f=Math.floor(l+10),this.availableSlideHeight=e-2*l;e=(k-player.width)/2;if(0<e)j=e+g+10,h=e+10,this.availableSlideWidth=k-2*e;if(player.isIE&&!player.hasCompensatedIESize)player.width-=2,player.hasCompensatedIESize=!0;b="#slideframe{margin-left:"+j+"px!important;margin-right:"+
h+"px!important;margin-top:"+f+"px!important;top:"+b+"px!important;}#slideframe, .slide{width:"+player.width+"px;height:"+player.height+"px;}.landscape_menu{height: "+i+"px;}.landscape_menu{display: "+(d||c?"block":"none")+";}.landscape_menu>#menu_tabs,.landscape_menu>#menu_container{display: "+(d?"block":"none")+";}.interstitial{height:"+window.innerHeight+"px;}";Frame.current.options.seekbar||(b+=".player_controls{display:none!important;}");if(!player.rotateLandscapeStyleSheet)player.rotateLandscapeStyleSheet=
document.createElement("style"),document.body.appendChild(player.rotateLandscapeStyleSheet);player.rotateLandscapeStyleSheet.innerHTML=b;player.landscapeScale=1;player.zoom=1;(d||c)&&$(".landscape_menu").css("display","");a!=this.availableSlideWidth&&player.currentSlide()&&player.currentSlide().ref&&player.currentSlide().fitToContainer()}};
DefaultFrame.prototype.updateFrameLayout=function(){if(!(player.isMobile&&!player.hasNavOutsideFrame||this.isPhone)){var a=DefaultFrame.getWindowSize(!1),b=a.width,c=a.height,d=story.frameWidth-2,e=story.frameHeight-2,a=1;if(player.scaleToFit){a=story.frameWidth/story.frameHeight>b/c?b/story.frameWidth:c/story.frameHeight;$("document.body").css("overflow","hidden");if(a!=player.frameScale&&1!=a)player.frameScale=a,$.each(story.children,function(a,b){"Window"==b.innerType&&b.resize()});if(player.isMobile){var f=
DefaultFrame.getWindowSize(!1),f=0.5*Math.min(f.width,f.height),g=$("div.launch_interstitial>a");g.css("width",f+"px");g.css("height",f+"px");g.css("margin-left",-parseInt(f/2)+"px");g.css("margin-top",-parseInt(f/2)+"px")}}f=parseInt((c-e*a)/2-1);g=parseInt((b-d*a)/2-1);player.scaleWithTransform||(f=parseInt((c-e*a)/2/a-1),g=parseInt((b-d*a)/2/a-1));player.isIE&&(g-=0,f+=1,d-=1,e-=1);0>f&&(f=0);0>g&&(g=0);this.containerWidth=d;this.containerHeight=e;this.containerLeft=g;this.containerTop=f;this.aspectRatio=
d/e;$("#framewrap").css("width",d);$("#framewrap").css("height",e);$("#framewrap").css("top",f);$("#framewrap").css("left",g);b="";b=player.scaleWithTransform?"#framewrap{-webkit-transform-origin:top left;-webkit-transform:translate3d(0px,0px,0px) scale("+a+");-moz-transform-origin:top left;-moz-transform:translate3d(0px,0px,0px) scale("+a+");-ms-transform-origin:top left;-ms-transform:translate(0px,0px) scale("+a+");}":"#framewrap{zoom:"+a+";-webkit-transform-origin:top left;-webkit-transform:translate3d(0px,0px,0px);-moz-transform-origin:top left;-moz-transform:translate3d(0px,0px,0px)-ms-transform-origin:top left;-ms-transform:translate(0px,0px)}";
if(!player.frameLandscapeStyleSheet)player.frameLandscapeStyleSheet=document.createElement("style"),document.body.appendChild(player.frameLandscapeStyleSheet);player.frameLandscapeStyleSheet.innerHTML=b;this.frameScale=a;player.frameScale=a;var h=0;$(".toptab").each(function(a,b){$(b).hasClass("customlink")||(h+=$(b).width())});b=Math.floor((this.availableSlideWidth-h)/this.customTabCount);$(".toptab.customlink").css("max-width",b+"px")}};
DefaultFrame.prototype.getTextLabel=function(a){return $(this.xml).find("string_table").first().children("string[id='"+a+"']").text()};
DefaultFrame.prototype.updateTextLabels=function(){$(this.xml).find("string_table").first().children("string").each(function(a,b){var c=$(b).attr("id"),d=$(b).text(),e=$(".label."+c);0<e.length&&"outline"!=c&&(e.text(d),e.parent().hasClass("controlbar-button")&&(c=player.isMobile?0.88:0.82,player.isFF&&(c=1),c=e.get(0).offsetWidth*(1-c),0!=c&&!e.get(0).previousSibling&&"relative"!=e.css("position")&&(e.css("position","relative"),e.css("left",c))))})};
DefaultFrame.prototype.setProgressTime=function(a,b,c){if(a==Frame.WINDOW_FRAME&&(a=ProgressBar.getCurrentProgressBar()))a.index=b,a.count=c,a.update();this.controlTimeElapsed&&this.controlTimeRemaining&&(0<this.controlTimeElapsed.length&&this.controlTimeElapsed.text(player.timeFormat(b)),0<this.controlTimeRemaining.length&&this.controlTimeRemaining.text(player.timeFormat(b-c)))};
DefaultFrame.prototype.setPresentationTime=function(a,b){if(this.options.time_enabled||this.options.elapsedandtotaltime){var c=this.options.time_format;this.options.elapsedandtotaltime&&"none"==this.options.time_format&&(c="totalelapsed");if(!this.presentationTimer)this.presentationTimer=$('<span class="presentation_timer"></span>'),$("#timer_section").append(this.presentationTimer);$("#storytitle").show();(c=TimerComponent.Format(a,b,c,this.rtl))&&(c="("+c+")");this.presentationTimer.text(c)}};
DefaultFrame.prototype.setTimerVisible=function(a){if(!this.timerComponent)this.timerComponent=new TimerComponent;a?(this.timerComponent.show(),$(document.body).addClass("hastimer")):(this.timerComponent.hide(),$(document.body).removeClass("hastimer"))};DefaultFrame.prototype.setTimerTime=function(a,b){if(!this.timerComponent)this.timerComponent=new TimerComponent;this.timerComponent.currentPosition=a;this.timerComponent.duration=b;this.timerComponent.render()};
DefaultFrame.prototype.setMetaData=function(){};
DefaultFrame.prototype.updatePresenter=function(a){var b=FrameKit.presenterVisible;Presenter.clearPresenters();if(!a)a=player.currentSlide().presenterref;Frame.current.applyBackgroundDirect("logo","bg",".logo_background>.logo_section");Frame.current.applyColorDirect("logo","shadow",".logo_background","box-shadow"," 0px 1px 0px 0px","");Frame.current.applyBackgroundDirect("infopanel","bg",".logo_background>.presenter_section");Frame.current.applyBackgroundDirect("infopanel","bg",".logo_background>.presenter_video_section");
Frame.presenterTextVisible=!1;Frame.presenterVideoVisible=!1;if(player.currentSlide().presenterVideoUrl)return-1<player.currentSlide().presenterVideoUrl.indexOf(".swf")?(Frame.presenterVideoVisible=!1,null):this.updatePresenterVideo(player.currentSlide().presenterVideoUrl,a);var c=null;if(a&&"none"!=a){$(".landscape_menu").removeClass("no_logo");$(".logo_background").show();if(c=this.presenters[a])c.show(),player.currentSlide().presenter=c,FrameKit.presenterVisible=!0,Frame.presenterTextVisible=!0;
else if(!this.options.logo_enabled||!FrameKit.logoVisible)$(".landscape_menu").addClass("no_logo"),$(".logo_background").hide();if(!this.options.logo_enabled||!FrameKit.logoVisible)Frame.current.applyBackgroundDirect("infopanel","bg",".logo_background>.logo_section"),Frame.current.applyColorDirect("infopanel","shadow",".logo_background","box-shadow"," 0px 1px 0px 0px","")}else!this.options.logo_enabled||!FrameKit.logoVisible?($(".landscape_menu").addClass("no_logo"),$(".logo_background").hide()):
($(".landscape_menu").removeClass("no_logo"),$(".logo_background").show(),Frame.current.applyBackgroundDirect&&(Frame.current.applyBackgroundDirect("logo","bg",".logo_background>.logo_section"),Frame.current.applyBackgroundDirect("logo","bg",".logo_background>.presenter_section"),Frame.current.applyBackgroundDirect("logo","bg",".logo_background>.presenter_video_section"),Frame.current.applyColorDirect("logo","shadow",".logo_background","box-shadow"," 0px 1px 0px 0px",""))),FrameKit.presenterVisible=
!1;b!=FrameKit.presenterVisible&&setTimeout(function(){Frame.current.updatePlayerLayout()},0);return c};
DefaultFrame.prototype.updatePresenterVideo=function(a,b){$(".landscape_menu").removeClass("no_logo");$(".logo_background").show();var c=this.presenters[a];if(!c)b&&"none"!=b?(c=this.presenters[b].copy(),c.hasText=!0):(c=new Presenter,c.hasText=!1),c.createVideoRef(a,player.currentSlide().presenterVideoWidth,player.currentSlide().presenterVideoHeight,player.currentSlide()),this.presenters[a]=c;Frame.presenterTextVisible=c.hasText;c.show();player.currentSlide().presenter=c;FrameKit.presenterVisible=
!0;Frame.presenterVideoVisible=!0;if(!this.options.logo_enabled||!FrameKit.logoVisible)Frame.current.applyBackgroundDirect("infopanel","bg",".logo_background>.logo_section"),Frame.current.applyColorDirect("infopanel","shadow",".logo_background","box-shadow"," 0px 1px 0px 0px","");return c};
DefaultFrame.prototype.updateInfoPanel=function(a){var b=FrameKit.logoVisible&&this.options.logo_enabled;$(".logo_section").show();$(".presenter_section").show();Frame.presenterVideoVisible&&a&&($(".presenter_video_section").removeClass("roundbottom, roundtop"),b||($(".logo_section").hide(),$(".presenter_video_section").addClass("roundtop")),Frame.presenterTextVisible||($(".presenter_section").hide(),$(".presenter_video_section").addClass("roundbottom")),a.setMask(!b&&!a.narrowVideo,!Frame.presenterTextVisible&&
!a.narrowVideo))};
DefaultFrame.prototype.tickPresentationTimer=function(){var a=player.timelineManager.getActiveTimelineSlide();if(a&&!(!this.options.time_enabled&&!this.options.elapsedandtotaltime||-1==a.starttime)){var b=this.options.time_format;this.options.elapsedandtotaltime&&"none"==this.options.time_format&&(b="totalelapsed");if(!this.presentationTimer)this.presentationTimer=$('<span class="presentation_timer"></span>'),$("#timer_section").append(this.presentationTimer);$("#storytitle").show();var c=Math.min(a.timeline.getCurrentTime(),
a.duration),c=a.starttime+c;if("pause"==a.elapsedtimemode)c=a.starttime;(a=TimerComponent.Format(c,story.lessonduration,b,this.rtl))&&(a="("+a+")");this.presentationTimer.text(a)}};
DefaultFrame.prototype.debugTopNav=function(){var a=this;this.topNavSelector=$("<div class='topnavselector'></div>");$(document.body).append(this.topNavSelector);var b=function(b){var d=$("<input id='box_"+b+"' type='checkbox'><label for='box_"+b+"'>"+b+"</label>");d.first()[0].checked=Frame.current[b];d.click(function(){var a=d.first()[0].checked;Frame.current[b]=a;Frame.current.updateLayout()});a.topNavSelector.append(d)};b("top_bar_hidden");b("hasLinksLeft");b("hasLinksRight");$("#topbar").css("background-color",
"aqua");$("#toplinks_right").css("background-color","yellow");$("#toplinks_left").css("background-color","orange");$("#topbar > #storytitle").css("background-color","lime")};DefaultFrame.prototype.setControlEnabled=function(a,b){b?FrameKit.controlMap[a].removeClass("disabled"):FrameKit.controlMap[a].addClass("disabled");this.currentControlEnabled[a]=b};
DefaultFrame.prototype.setWindowControlEnabled=function(a,b){b?Frame.windowControlMap[a].removeClass("disabled"):Frame.windowControlMap[a].addClass("disabled");this.currentWindowControlEnabled[a]=b};DefaultFrame.prototype.setControlVisible=function(a,b){var c=FrameKit.controlMap[a];b?(c.show(),c.addClass("visible")):(c.hide(),c.removeClass("visible"));this.currentControlLayout[a]=b};
DefaultFrame.prototype.setWindowControlVisible=function(a,b){var c=Frame.windowControlMap[a];b?(c.show(),c.addClass("visible")):(c.hide(),c.removeClass("visible"));this.currentWindowControlLayout[a]=b};Frame.findCurrentFrame=function(){var a=null;if(self!=top&&!player.isCrossDomainFrame)try{$.each(top.document.getElementsByTagName("iframe"),function(b,d){d.contentWindow==self&&(a=d)}),$.each(top.document.getElementsByTagName("frame"),function(b,d){d.contentWindow==self&&(a=d)})}catch(b){}return a};
DefaultFrame.prototype.shouldClick=function(a){return!this.buttonTouchMoved&&!$(a).hasClass("disabled")&&!$(a).hasClass("locked")};
DefaultFrame.prototype.bind=function(){var a=this;this.controlPause=$(".control-pauseplay .pause");this.controlPlay=$(".control-pauseplay .play");this.controlTimeElapsed=$(".time_elapsed");this.controlTimeRemaining=$(".time_remaining");var b=function(){a.shouldClick(this)&&!this.currentWindow&&!player.showingInterstitial&&a.raiseSubmit()},c=function(){a.shouldClick(this)&&(player.isIOS&&player.pauseIfSimple(event),a.raiseNext())},d=function(){a.shouldClick(this)&&(player.isIOS&&player.pauseIfSimple(event),
a.raisePrevious())},e=function(){a.shouldClick(this)&&a.raiseSubmitAll()},f=function(){a.shouldClick(this)&&a.raiseFinish()};if(player.isMobile){player.pauseIfSimple=function(){Frame.current.currentSlideHasSimpleNavigation&&player.timelineManager.pauseAllTimelines()};var g=function(b){if(!$(this).hasClass("disabled")&&!$(this).hasClass("locked")){a.buttonTouchMoved=!1;if(1<b.originalEvent.touches.length)a.buttonTouchMoved=!0;a.buttonDownX=b.originalEvent.touches[0].screenX;a.buttonDownY=b.originalEvent.touches[0].screenY}},
h=function(b){if(!$(this).hasClass("disabled")&&!$(this).hasClass("locked")){var c=Math.abs(a.buttonDownX-b.originalEvent.touches[0].screenX),b=Math.abs(a.buttonDownY-b.originalEvent.touches[0].screenY);if(20<c||20<b)a.buttonTouchMoved=!0}};$(".control-submit").bind("touchstart",g);$(".control-next").bind("touchstart",g);$(".control-previous").bind("touchstart",g);$(".control-submitall").bind("touchstart",g);$(".control-finish").bind("touchstart",g);$(".control-submit").bind("touchmove",h);$(".control-next").bind("touchmove",
h);$(".control-previous").bind("touchmove",h);$(".control-submitall").bind("touchmove",h);$(".control-finish").bind("touchmove",h);$(".control-submit").bind("touchend",b);$(".control-submitall").bind("touchend",e);$(".control-finish").bind("touchend",f);$(".control-next").bind("touchend",c);$(".control-previous").bind("touchend",d)}else $(".control-submit").bind("click",b),$(".control-next").bind("click",c),$(".control-previous").bind("click",d),$(".control-submitall").bind("click",e),$(".control-finish").bind("click",
f);$(".control-menu").bind("click",function(){a.slideList&&a.slideList.toggle()});$(".button,.controlbar-button").bind("mousedown touchstart",function(){$(this).addClass("pressed")});$(".button,.controlbar-button").bind("mouseup mouseout touchend",function(){$(this).removeClass("pressed")});b=player.isMobile?"touchstart":"click";$(".control-pauseplay .play").bind(b,function(){player.timelineManager.playActiveTimeline()});$(".control-pauseplay .pause").bind(b,function(){player.timelineManager.pauseActiveTimeline()});
$(".control-restart").bind(b,function(){player.restart()});player.volumeSlider=new VolumeSlider($(".contentpane>#controls").find(".control-volume"));player.volumeSlider.onDragUpdate=function(a){$("audio,video").each(function(b,c){c.volume=Math.min(a*player.clipVolume,1)});Audio.setMasterVolume&&Audio.setMasterVolume(a);VolumeSlider.updateVolumeIcon(a)};$(document.body).bind("touchend",function(){player.touchFlickIsHorizontal=null;player.touchScrolling=!1;player.windowTouchScrolling=!1});$(document.body).bind("touchstart",
function(a){if(player.scrollDebug){var b=a.originalEvent.touches;if(!player.touchDivs)player.touchDivs=[];for(var c=0;c<b.length;c++){var d;player.touchDivs[c]?d=player.touchDivs[c]:(d=$("<div class='touchdiv'></div>"),d.css("left",50*c),$(document.body).append(d),player.touchDivs[c]=d);window!=top?d.css("background-color","red"):d.css("background-color","green");setTimeout(function(){d.hide()},1E3);d.show()}}if(a&&a.originalEvent&&a.originalEvent.touches&&1<=a.originalEvent.touches.length)player.touchStart=
{left:a.originalEvent.touches[0].pageX,top:a.originalEvent.touches[0].pageY},player.touchFlickIsHorizontal=null,player.touchScrolling=!1,player.windowTouchScrolling=!1});$(document.body).bind("touchmove",function(a){var b=a.originalEvent.touches;if(player.scrollDebug){if(!player.touchDivs)player.touchDivs=[];for(var c=0;c<b.length;c++){var d=player.touchDivs[c];d.css("background-color","orange");setTimeout(function(){d.hide()},1E3);d.show()}}if(player.allowTouchScroll||2==b.length&&window.pinch||
1==b.length&&window.pinch&&window.pinch.panning)return!0;if(2<b.length)return!1;if(player.windowTouchScrolling)return a.originalEvent.stopPropagation(),a.originalEvent.preventDefault(),player.scrollDebug&&$(".touchdiv").css("background-color","red"),!1;c=function(){var b=parseInt(a.originalEvent.touches[0].pageX-player.touchStart.left),c=parseInt(a.originalEvent.touches[0].pageY-player.touchStart.top);return Math.abs(b)>Math.abs(c)};if("VIDEO"==a.target.tagName)return player.scrollDebug&&$(".touchdiv").css("background-color",
c()?"mediumorchid":"yellow"),c();for(var e=!1,f=!1,b=a.target;!e&&b;){e=$(b).hasClass("scrollarea")||"VIDEO"==b.tagName;if((f=$(b).hasClass("dragitem"))&&!player.windowTouchScrolling)return player.scrollDebug&&$(".touchdiv").css("background-color","blue"),player.touchScrolling=!0;if(e&&player.touchStart){if(null==player.touchFlickIsHorizontal)player.touchFlickIsHorizontal=c();c=parseInt(a.originalEvent.touches[0].pageY-player.touchStart.top);if(player.touchFlickIsHorizontal||0>=b.scrollTop&&0<c||
b.scrollTop>=b.scrollHeight-b.offsetHeight&&0>c||player.windowTouchScrolling)return player.scrollDebug&&$(".touchdiv").css("background-color","cyan"),!1;player.scrollDebug&&$(".touchdiv").css("background-color","yellow");return player.touchScrolling=!0}b=b.parentNode}(player.isFramedOffset||player.hasNavOutsideFrame)&&$(".touchdiv").css("background-color","purple");return player.isFramedOffset||player.hasNavOutsideFrame});$(window).bind("scroll",function(){if(player.isIOS)player.windowTouchScrolling=
!0;return player.isFramedOffset||player.hasNavOutsideFrame});$(window).unbind("keydown");$(window).bind("keydown",function(b){return a.raiseKeyPress(b)})};DefaultFrame.prototype.setPlaying=function(a,b){this.controlPause&&this.controlPlay&&(b?(this.controlPause.hide(),this.controlPlay.show(),$("#controls").show(),$(document.body).removeClass("paused")):(this.controlPause.show(),this.controlPlay.hide()))};
DefaultFrame.prototype.setPlayerBlocked=function(a){if(a){var b=DefaultFrame.getWindowSize(!1);if(!player.blocknotice)player.blocknotice=$('<div class="blocked"></div>'),$(".blocked").css("left",Math.floor(b.width/2)-50),$(".blocked").css("top",Math.floor(b.height/2)-50),$(document.body).append(player.blocknotice);player.blockNoticeTimeout=setTimeout(function(){player.blocked&&(player.blocknotice.show(),$(".blocked").css("left",Math.floor(b.width/2)-50),$(".blocked").css("top",Math.floor(b.height/
2)-50))},500)}else clearTimeout(player.blockNoticeTimeout),player.blockNoticeTimeout=null,$(".blocked").hide()};
DefaultFrame.prototype.setSlide=function(a,b){var c=a.slideid;this.raiseBoundsChanged();if(b!=Frame.WINDOW_FRAME)(c=this.windows[b])&&c.titleRef&&c.titleRef.html(a.title);else{$("ul.menu_list li").removeClass("selected locked");$("ul.slidelist li").removeClass("selected locked");$(".controlbar-button.right,.control-submitall").removeClass("locked");$(".toptab.customlink").removeClass("locked");$(".progress-container").removeClass("locked");if(this.slideList){var d=this.slideList.markSelectedVisited(c);
if(this.selectedNode!=d)this.slideList.collapseSections(c,d,this.selectedNode),this.selectedNode=d}a.slidelock&&($("ul.menu_list li").addClass("locked"),$("ul.slidelist li").addClass("locked"),$(".controlbar-button.right,.control-submitall").addClass("locked"),$(".toptab.customlink").addClass("locked"),$(".progress-container").addClass("locked"));this.slideList&&this.slideList.scrollSelectedIntoView();Frame.current.transcriptPanel&&((c=Frame.current.transcriptPanel.transcripts[a.transcriptid])?c.show(a.title):
Frame.current.transcriptPanel.showTitleOnly(a.title));this.currentSlideHasSimpleNavigation=a.simplenavigation}};DefaultFrame.prototype.setSlideExit=function(){};DefaultFrame.prototype.setSlideVisited=function(a,b){b&&this.slideList&&this.slideList.markVisited(a)};DefaultFrame.prototype.createWindow=function(a){var b=new WindowComponent;b.loadFromXML(a);this.windows[b.id]=b;b.createRef();return b.contentRef};
DefaultFrame.prototype.setWindowVisible=function(a,b){var c=this.windows[a];c&&(b?c.show():c.hide())};DefaultFrame.prototype.getFrameBounds=function(){return this.frameBounds};DefaultFrame.prototype.getWindowBounds=function(a){this.currentWindow=null;if(a=this.windows[a]){var b=a.contentRef.offset();b.width=a.width;b.height=a.height;!a.isPrompt&&a.hasControls&&(b.height-=40*Frame.current.frameScale);this.currentWindow=a;return b}return{left:0,top:0,width:this.availableSlideWidth,height:this.availableSlideHeight}};
DefaultFrame.prototype.getSlideBounds=function(a,b){if(b){var c=b.offset();if(!player.scaleWithTransform&&(!this.currentWindow||!this.currentWindow.isExternal()))c.left*=this.frameScale,c.top*=this.frameScale;this.slideBounds=ppRect.FromWidthHeight(c.left,c.top,b.width(),b.height())}return this.slideBounds};DefaultFrame.prototype.getFrameScale=function(){return this.currentWindow&&this.currentWindow.isExternal()?1:this.frameScale};
DefaultFrame.prototype.getDragging=function(){return player.volumeSlider&&player.volumeSlider.dragging||this.currentWindow&&this.currentWindow.volumeSlider&&this.currentWindow.volumeSlider.dragging||this.progressBar&&this.progressBar.dragging||this.currentWindow&&this.currentWindow.progressBar&&this.currentWindow.progressBar.dragging};
DefaultFrame.getDeviceOrientation=function(){return player.isIOS&&player.isIOSlt8&&player.isCrossDomainFrame?FrameKit.isPortrait()?90:0:player.isCrossDomainFrame?window.orientation:top.window.orientation};
DefaultFrame.getWindowSize=function(a){if(player.isCrossDomainFrame)if(0!=window.innerWidth)a={width:window.innerWidth,height:window.innerHeight};else{if(!DefaultFrame.windowSizer)DefaultFrame.windowSizer=document.createElement("DIV"),DefaultFrame.windowSizer.className="windowsizer",document.body.insertBefore(DefaultFrame.windowSizer,document.body.childNodes[0]);a={width:DefaultFrame.windowSizer.offsetWidth,height:DefaultFrame.windowSizer.offsetHeight}}else a=a?{width:top.window.innerWidth,height:top.window.innerHeight}:
{width:window.innerWidth,height:window.innerHeight};return DefaultFrame.windowSize=a};DefaultFrame.resizeSpinners=function(){DefaultFrame.windowSize||DefaultFrame.getWindowSize(!1);var a=DefaultFrame.windowSize;$("#loadingSpinner").css("left",Math.floor(a.width/2)-50);$("#loadingSpinner").css("top",Math.floor(a.height/2)-50);$(".blocked").css("left",Math.floor(a.width/2)-50);$(".blocked").css("top",Math.floor(a.height/2)-50)};DefaultFrame.resizeSpinners();player.frameReady(new DefaultFrame);var SlideListNode=function(a,b){if(!b)b={},this.isRoot=!0;this.parent=a;this.link=b;this.lookupid=this.link.slideid?-1<this.link.slideid.indexOf("player")?this.link.slideid:"_player."+this.link.slideid:this.link.actionlinkid||"";this.children=[];this.listitems=[];this.expanded=!0;if(!b.nodes)b.nodes=[];b.nodes.push(this)};SlideListNode.traverse=function(a,b){b(a);for(var c=0;c<a.children.length;c++)SlideListNode.traverse(a.children[c],b)};
SlideListNode.prototype.find=function(a){var b=null;SlideListNode.traverse(this,function(c){if(c.slideid==a||c.actionlinkid==a)b=c});return b};SlideListNode.prototype.push=function(a){this.children.push(a)};SlideListNode.prototype.hasChildren=function(){return 0<this.children.length};SlideListNode.prototype.toggleExpand=function(){this.hasChildren()&&(this.expanded?this.collapse():this.expand(),this.updateDescendants())};SlideListNode.prototype.isMatch=function(a){return a==this.lookupid};
SlideListNode.prototype.expand=function(){this.expanded=!0};SlideListNode.prototype.collapse=function(a){a&&$.each(this.children,function(a,c){c.collapse(!0,!0)});this.expanded=!1};SlideListNode.prototype.show=function(){$.each(this.listitems,function(a,b){b.show()})};SlideListNode.prototype.hide=function(){$.each(this.listitems,function(a,b){b.hide()})};
SlideListNode.prototype.updateDescendants=function(a){var b=a||!this.expanded;$.each(this.children,function(a,d){b?d.hide():d.show();0<d.children.length&&!b&&d.expanded&&d.expand();d.updateDescendants(b)});this.expanded?$.each(this.listitems,function(a,b){b.addClass("open")}):$.each(this.listitems,function(a,b){b.removeClass("open")})};var SlideList=function(a){this.container=a||$(document.body);this.contentRef=this.ref=$('<ul id="slide_list" class="menu_list"></ul>');this.closed=!1;this.scroll={moved:!1};this.tree=new SlideListNode;player.simplenav&&(this.contentRef.removeClass("menu_list"),this.contentRef.addClass("slidelist"))};SlideList.arrDepthIndents=[];
SlideList.SetDepth=function(a,b,c){var d=12*b,c=SlideList.GetStringWidth(""+c),e=""+b+"_"+(""+c);if(0>SlideList.arrDepthIndents.indexOf(e)){if(!SlideList.styleSheet)SlideList.styleSheet=new CustomStyleSheet;var f="ul.slidelist li.depth"+e,g=Frame.current.rtl?"right":"left",h=Frame.current.rtl?"padding-right":"padding-left";SlideList.styleSheet.add(f,h,d+c+6+"px");0<c?(SlideList.styleSheet.add(f,"text-indent",b-c+4+"px"),SlideList.styleSheet.add(f+".has_children","text-indent",-(c+12)+"px"),SlideList.styleSheet.add(f+
".has_children>span",g,-(9*(b-1)+10+c)+"px"),SlideList.styleSheet.add(f+".has_children.open>span",g,-(9*(b-1)+12+c)+"px")):SlideList.styleSheet.add(f+".has_children",h,d-10+"px");SlideList.SetIconPositions(f,g,d);SlideList.styleSheet.build();SlideList.arrDepthIndents.push(e)}a.addClass("depth"+e)};
SlideList.SetIconPositions=function(a,b,c){SlideList.styleSheet.add(a+".correct:before",b,213-c+"px");SlideList.styleSheet.add(a+".incorrect:before",b,213-c+"px");SlideList.styleSheet.add(".toptab "+a+".correct:before",b,270-c+"px");SlideList.styleSheet.add(".toptab "+a+".incorrect:before",b,270-c+"px")};
SlideList.GetStringWidth=function(a){var b=0;if(a){var b=$("ul.slidelist").css("font-size")+" "+$("ul.slidelist").css("font-family"),c=Frame.current.rtl?"right":"left",a=$("<div>"+a+"</div>").css({position:"absolute","float":c,"white-space":"nowrap",visibility:"hidden",font:b}).appendTo($("body")),b=a.width();a.remove()}return b};
SlideList.prototype.build=function(a,b,c,d,e){var f=this,b=b||f.contentRef,c=c||"",d=d||1,e=e||new SlideListNode;f.hasBuilt=!0;if(!Frame.current.options.levelrestriction)Frame.current.options.levelrestriction=Frame.LEVEL_RESTRICTION_UNRESTRICTED;if(!Frame.current.options.levelbehavior)Frame.current.options.levelbehavior=Frame.LEVEL_BEHAVIOR_INSIDE;for(var g=function(a,c){var g=a.displaytext;c&&(g=c+" "+g);var h=$("<li>"+g+"</li>");a.slideid?h.attr("id",a.slideid):a.drawid&&h.attr("id",a.drawid);SlideList.SetDepth(h,
d,c);var i=new SlideListNode(e,a);e.push(i);h.toggleExpand=function(){i.toggleExpand();return!1};h.click(function(b){if(f.scroll.moved||Frame.current.currentWindow&&"MessageWnd"==Frame.current.currentWindow.id)return!1;if(h.hasClass("has_children")&&1==h.children("span").length){var c=h.children("span").position().left;if(b.offsetX<c+10&&!h.hasClass("neither"))return h.toggleExpand()}if($(this).hasClass("selected")||$(this).hasClass("locked"))return!1;if(Frame.current.options.flow==Frame.FLOW_LOCKED)return story.handleEvent("onobjectevent",
"nav_locked_mode",null,!1,!1,!0),!1;if(Frame.current.options.flow==Frame.FLOW_RESTRICTED&&!h.hasClass("visited"))return story.handleEvent("onobjectevent","nav_restricted_mode",null,!1,!1,!0),!1;if(a.actionlinkid)return Frame.current.raiseFollowActionLink(a.actionlinkid,Frame.current.options.flow),!1;Frame.current.raiseFollowSlideLink(a.slideid,Frame.current.options.flow);return!1});b.append(h);a.links&&(g=$("<span/>"),h.prepend(g),h.addClass("has_children open"),Frame.current.options.levelrestriction!=
Frame.LEVEL_RESTRICTION_UNRESTRICTED&&h.addClass("neither"),f.build(a.links,b,c,d+1,i));Frame.current.options.enableresultsicons&&(g=Frame.current.slideStatus[a.slideid])&&g.status&&h.addClass(g.status);i.listitems.push(h);a.expand||h.toggleExpand();g=a.slideid&&a.slideid.replace("_player.","");player.listSlidesViewed[g]&&f.markVisited(a.slideid)},h=Frame.current.options.autonumber,k=0,i,j=0;j<a.length;j++){var l=a[j];if(l.drawid){if(l=Frame.current.drawNavData[l.drawid]||Frame.current.drawNavData["_player."+
l.drawid])for(var m=0;m<l.length;m++){var o=l[m];o.showinmenu&&(i=h?c+(k+1)+".":"",g({slideid:o.slideid,displaytext:o.title,expand:!0,parent:e},i),k++)}}else i=h?c+(j+1)+".":"",g(l,i)}};SlideList.prototype.toggle=function(){this.visible?this.hide():this.show()};
SlideList.prototype.show=function(){if(!this.visible)this.visible=!0,Transition.applyCss({"-webkit-transition-property":"none","-webkit-transition-duration":"0ms",opacity:1,display:"block"},this.portraitContainer),$(".control-menu").addClass("active"),this.refresh(),this.scrollSelectedIntoView(1)};SlideList.prototype.hide=function(){if(this.visible)this.visible=!1,this.portraitContainer&&this.portraitContainer.hide(),$(".control-menu").removeClass("active")};
SlideList.prototype.refresh=function(){this.scroll={moved:!1}};SlideList.prototype.scrollSelectedIntoView=function(a){a=isNaN(a)?500:a;$(".slidelist .selected").each(function(a,c){var d=$(c).closest(".slidelist"),e=$(c).position().top,f=$(c).height(),g=d.position().top,h=d.parent().height(),k=d.parent().get(0).scrollTop,i=e-g-f,e=e-g-h+2*f;if(k<e)d.parent().get(0).scrollTop=e;if(k>i)d.parent().get(0).scrollTop=i})};
SlideList.prototype.markNode=function(a,b){a.listitems&&$.each(a.listitems,function(a,d){d.addClass(b)})};SlideList.prototype.markVisited=function(a){var b=this,c=null;SlideListNode.traverse(this.tree,function(d){if(d.isMatch(a)){b.markNode(d,"visited");b.markParentVisted(d);var e=d.link.slideid||d.link.actionlinkid,f=c?c.link.slideid||c.link.actionlinkid:"";if(e==a||!c||e.length>f.length)c=d}});return c};
SlideList.prototype.markParentVisted=function(a){var b=a.parent;if(b){var a=a.link.slideid?story.parseObjref(a.link.slideid).target:!1,c=b.link.slideid?story.parseObjref(b.link.slideid).target:!1;if(""==b.lookupid||c&&"Scene"==c.innerType&&a.parent==c)this.markParentVisted(b),this.markNode(b,"visited")}};SlideList.prototype.markSelectedVisited=function(a){this.unselectAll();(a=this.markVisited(a))&&this.markNode(a,"selected");return a};
SlideList.prototype.unselectAll=function(){$("ul.menu_list li").removeClass("selected");$("ul.slidelist li").removeClass("selected")};SlideList.parseDepth=function(a){var b=-1;if(a.get(0).classList)for(var c in a.get(0).classList){var d=a.get(0).classList[c];d&&d.indexOf&&0==d.indexOf("depth")&&(b=parseInt(d.replace("depth","")))}return b};SlideList.prototype.linkIsInTree=function(a){var b=!1;SlideListNode.traverse(this.tree,function(c){c.isMatch(a)&&(b=!0)});return b};
SlideList.prototype.collapseSections=function(a,b,c){if(Frame.navLinks&&Frame.current.slideList&&b){for(;c&&c.parent&&!c.parent.isRoot;)c=c.parent;this.linkIsInTree(a)?Frame.current.options.autocollapse&&c&&c.collapse():this.unselectAll();if(Frame.current.options.levelrestriction==Frame.LEVEL_BEHAVIOR_INSIDE&&Frame.current.options.levelbehavior==Frame.LEVEL_BEHAVIOR_REACHED)Frame.current.options.levelbehavior=Frame.LEVEL_BEHAVIOR_INSIDE;a=Frame.current.options.levelbehavior==Frame.LEVEL_BEHAVIOR_INSIDE?
b:null;for(c=Frame.current.options.levelrestriction==Frame.LEVEL_BEHAVIOR_INSIDE?b:null;b&&!b.isRoot;)Frame.current.options.levelbehavior!=Frame.LEVEL_BEHAVIOR_MANUAL&&b!=a&&b.expand(),b!=c&&$.each(b.listitems,function(a,b){b.removeClass("neither")}),b=b.parent;this.tree.updateDescendants()}};SlideList.prototype.collapseAll=function(){this.tree.collapse(!0);this.tree.expand();this.tree.updateDescendants()};
SlideList.shorten=function(a,b){if(a.length>b){for(var c=a.substr(0,b-3),d=c.length-1;0<d;d--)if(" "==c.substr(d,1))return c.substr(0,d)+"&hellip;";return"&hellip;"}return a};var ProgressBar=function(a,b,c){this.container=a||$(document.body);this.ref=b;this.draggable=c;this.dragging=!1;this.index=0;this.zoomModifier=this.count=1;this.lastPercent=-1;this.height=ProgressBar.DefaultHeight;this.containerHeight=ProgressBar.DefaultContainerHeight;this.borderRadius=ProgressBar.DefaultBorderRadius;this.handleRadius=ProgressBar.DefaultHandleRadius;this.handleThickness=ProgressBar.DefaultHandleThickness;this.handleFill=ProgressBar.DefaultHandleFill;this.onDragUpdate=null;this.ref||
this.createRef();c&&this.bindDragEvents();this.progressBarElement=this.ref.children(".progress-bar");this.lastProgressPercent=-1};ProgressBar.DefaultContainerHeight=16;ProgressBar.DefaultHeight=16;ProgressBar.DefaultBorderRadius=4;ProgressBar.DefaultHandleRadius=0;ProgressBar.DefaultHandleThickness=0;ProgressBar.DefaultHandleFill=!1;
ProgressBar.prototype.createRef=function(){if(this.ref)return!1;this.ref=$('<div class="progress-container"><div class="progress-bar"></div></div>');this.container.append(this.ref);return!0};ProgressBar.prototype.show=function(){this.ref.show()};ProgressBar.prototype.hide=function(){this.ref.hide()};
ProgressBar.prototype.update=function(){if(Frame.current.currentWindow&&Frame.current.currentWindow.progressBar&&this==Frame.current.progressBar)Frame.current.currentWindow.progressBar.update();else if(0!=this.progressBarElement.length){var a=parseFloat(this.index/this.count);1<a&&(a=1);var b=Frame.current.progressWidth?Frame.current.progressWidth:this.progressBarElement.width(),c=b-2*this.handleRadius-2*this.handleThickness;if(this.lastProgressPercent!=a||c!=this.lastProgressWidth){this.lastProgressPercent=
a;if(this.seekCanvas){if(b!=this.lastProgressWidth)this.lastProgressWidth=b,this.seekCanvas.width=b}else this.seekCanvas=document.createElement("canvas"),this.seekCanvas.style.webkitTransform="translate3d(0px,0px, 0px)",this.seekCanvas.width=b,this.seekCanvas.height=this.progressBarElement.height(),this.progressBarElement[0].appendChild(this.seekCanvas);var d=this.seekCanvas.getContext("2d"),a=c*a,e=this.height,f=0;if(a>=c-3)f=this.borderRadius;d.clearRect(0,0,b,this.containerHeight);b=Math.floor((this.containerHeight-
this.height)/2);d.fillStyle=Frame.current.seekBackgroundColor;this.drawRoundRect(d,this.handleRadius+this.handleThickness,b,c,e,{upperLeft:this.borderRadius,lowerLeft:this.borderRadius,upperRight:this.borderRadius,lowerRight:this.borderRadius});d.fill();d.fillStyle=Frame.current.seekColor;d.strokeStyle=Frame.current.seekColor;d.beginPath();this.drawRoundRect(d,this.handleRadius+this.handleThickness,b,a,e,{upperLeft:this.borderRadius,lowerLeft:this.borderRadius,upperRight:f,lowerRight:f});d.fill();
if(0<this.handleRadius){d.beginPath();d.arc(a+this.handleRadius+this.handleThickness,b+this.height/2,this.handleRadius,0,2*Math.PI,!1);d.lineWidth=this.handleThickness;if(!this.handleFill)d.globalCompositeOperation="destination-out";d.fill();d.globalCompositeOperation="source-over";d.stroke()}else if(a<c-2)d.beginPath(),d.strokeStyle="#B8B8B8",d.lineWidth=1,d.moveTo(a,b),d.lineTo(a,e+b),d.stroke()}}};
ProgressBar.prototype.drawRoundRect=function(a,b,c,d,e,f){var g={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0};if("object"===typeof f)for(var h in f)g[h]=f[h];a.beginPath();a.moveTo(b+g.upperLeft,c);a.lineTo(b+d-g.upperRight,c);a.quadraticCurveTo(b+d,c,b+d,c+g.upperRight);a.lineTo(b+d,c+e-g.lowerRight);a.quadraticCurveTo(b+d,c+e,b+d-g.lowerRight,c+e);a.lineTo(b+g.lowerLeft,c+e);a.quadraticCurveTo(b,c+e,b,c+e-g.lowerLeft);a.lineTo(b,c+g.upperLeft);a.quadraticCurveTo(b,c,b+g.upperLeft,c);a.closePath()};
ProgressBar.prototype.setPercent=function(a){this.index=a*this.count};ProgressBar.prototype.getPercent=function(){return parseFloat(this.index)/parseFloat(this.count)};
ProgressBar.prototype.bindDragEvents=function(){var a=this;a.dragging=!1;var b=function(b){a.lastPercent=-1;var d=player.timelineManager.getActiveTimelineOwner();if(d&&d.enableseek&&!Frame.current.readOnlySeekbar&&!$(this).hasClass("locked"))a.dragging=!0,a.wasPlaying=player.timelineManager.getIsActiveTimelinePlaying(),player.timelineManager.pauseActiveTimeline(),c(b)},c=function(b){if(a.dragging){var c=a.ref.offset().left,d=a.ref.width()*a.zoomModifier;swipe.parseEventCoords(b);b=(swipe.x-c)/d;0>
b&&(b=0);1<b&&(b=1);if(b!=a.lastPercent)a.lastPercent=b,Frame.current.raiseSetProgress(b)}},d=function(b){var d=player.timelineManager.getActiveTimelineOwner();d&&d.enableseek&&!Frame.current.readOnlySeekbar&&a.dragging&&(c(b),setTimeout(function(){a.dragging=!1},0),a.wasPlaying&&parseInt(a.index)!=parseInt(a.count)&&player.timelineManager.playActiveTimeline())};player.isMobile?($(this.ref).bind("touchstart",b),$(window).bind("touchmove",c),$(document.body).bind("touchmove",c),$(this.ref).bind("touchend",
d),$(document.body).bind("touchend",d),$(window).bind("touchend",d)):($(this.ref).bind("mousedown",b),$(window).bind("mousemove",c),$(this.ref).bind("mouseup",d),$(document.body).bind("mouseup",d),$(window).bind("mouseup",d))};ProgressBar.getCurrentProgressBar=function(){return Frame.current.currentWindow?null:Frame.current.progressBar};function ResourcesPanel(){}ResourcesPanel.prototype.loadFromXML=function(a){var b=this;this.xml=a;this.description=$(a).attr("description");this.resources=[];$(a).children("resources").children("resource").each(function(a,d){var e={};e.url=$(d).attr("url");e.image=player.basepath+$(d).attr("image");e.title=$(d).attr("title");b.resources.push(e)});this.createRef()};
ResourcesPanel.prototype.createRef=function(){if(this.ref)return!1;var a=$("<div class='resources_container'></div>");a.append($("<div class='resources_description'>"+this.description+"</div>"));a.append($("<hr/>"));var b=$("<ul></ul>");$.each(this.resources,function(a,d){var e=$("<li><a href='"+d.url+"' target='_blank'><img src='"+d.image+"' class='resources_icon'/>"+d.title+"</a></li>");b.append(e)});a.append(b);this.ref=a;return!0};function GlossaryPanel(){}GlossaryPanel.prototype.loadFromXML=function(a){var b=this;this.xml=a;this.terms=[];$(a).children("terms").children("term").each(function(a,d){var e={};e.title=$(d).attr("title");e.definition=$(d).text();b.terms.push(e)});this.createRef()};
GlossaryPanel.prototype.createRef=function(){if(this.ref)return!1;var a=$("<div class='glossary_container'></div>"),b=$("<div id='glossaryscroll' class='glossary_section scrollarea'></div>");b.append($("<div class='glossary_section_header label terms'>Terms</div>"));var c=$("<ul></ul>");$.each(this.terms,function(a,b){var f=$("<li><a href='javascript:void(null);' >"+b.title+"</a></li>");f.click(function(){$(".definitiontext").hide();$(".glossary_container .active").removeClass("active");b.defref&&
(f.addClass("active"),b.defref.show())});c.append(f)});b.append(c);a.append(b);b=$("<div class='glossary_section scrollarea vertical'></div>");b.append($("<div class='glossary_section_header label definition'>Definition</div>"));$.each(this.terms,function(a,c){var f=$("<div class='definitiontext'>"+c.definition+"</div>");c.defref=f;b.append(f)});a.append(b);this.ref=a;return!0};function TranscriptPanel(){}
TranscriptPanel.prototype.loadFromXML=function(a){var b=this;this.xml=a;this.transcripts={};$(a).children("slidetranscripts").children("slidetranscript").each(function(a,d){var e={};e.slideid=$(d).attr("slideid");e.notespng=$(d).attr("notespng");e.slidebank="true"==$(d).attr("slidebank");e.content=$(d).text();b.transcripts[e.slideid]=e;Frame.current.transcripts[e.slideid]=e;e.show=function(a){b.titleref.html(a);$(".transcript_content").hide();e.contentref&&e.contentref.show()}});this.createRef()};
TranscriptPanel.prototype.createRef=function(){if(this.ref)return!1;var a=$("<div class='transcript_container'></div>");this.titleref=$("<div class='transcript_title'></div>");a.append(this.titleref);$.each(this.transcripts,function(b,c){var d=c.content;c.notespng&&-1==c.notespng.indexOf(".swf")&&(d="<img src='"+(player.basepath+c.notespng)+"'>");d=$("<div class='transcript_content'><hr/>"+d+"</div>");c.contentref=d;a.append(d)});this.ref=a;return!0};
TranscriptPanel.prototype.showTitleOnly=function(a){this.titleref.html(a);$(".transcript_content").hide();if(!this.emptyContentRef)this.emptyContentRef=$("<div class='transcript_content'><hr/></div>"),this.ref.append(this.emptyContentRef);this.emptyContentRef.show()};function Presenter(){this.isVideo=!1}Presenter.prototype.loadFromXML=function(a){this.xml=a;this.id=$(a).attr("id");this.photoSwf=$(a).attr("photo");this.mobilephoto=$(a).attr("mobilephoto");this.name=$(a).attr("name");this.title=$(a).attr("title");this.email=$(a).attr("email");this.bioHtml=$(a).children("bioHtml").text();this.photoImageSrc=this.mobilephoto;this.createRef()};Presenter.HEIGHT_RATIO=0.76;Presenter.prototype.copy=function(){var a=new Presenter;a.loadFromXML(this.xml);return a};
Presenter.prototype.createRef=function(){if(this.ref)return!1;var a=$("<div class='presenter_info'><div class='imgwrap'><img></div><span class='presenter_name'/><span class='presenter_title'/><a class='presenter_link'/></div>");this.ref=a;a=a.find("img");this.photoImageSrc?a.attr("src",player.basepath+this.photoImageSrc):a.remove();this.setPresenterInfo();return!0};
Presenter.prototype.createVideoRef=function(a,b,c,d){this.videoUrl=player.basepath+a;this.videoUniqueKey=Video.getStoreReference(d,this.videoUrl);var a=$("<div class='presenter_info video'><span class='presenter_name'/><span class='presenter_title'/><a class='presenter_link'/></div>"),d=$("<video/>"),e=FrameKit.NAV_WIDTH,f=Math.round(c*FrameKit.NAV_WIDTH/b),g=Math.round(FrameKit.NAV_WIDTH*Presenter.HEIGHT_RATIO);f>g&&(f=g,e=Math.round(b*g/c));if(e>FrameKit.NAV_WIDTH)e=FrameKit.NAV_WIDTH,f=Math.round(c*
e/b);this.narrowVideo=e<FrameKit.NAV_WIDTH;this.width=e;this.height=f;this.video=d;d.attr("width",e);d.attr("height",f);d.attr("src",this.videoUrl);this.ref=a;this.setPresenterInfo();this.isVideo=!0};Presenter.prototype.setMask=function(a,b){var c=Presenter.getVideoMaskUrl(this.width,this.height,a,b);this.video.css("-webkit-mask-image",c);this.video.css("mask-image",c)};
Presenter.getVideoMaskUrl=function(a,b,c,d){var e=document.createElement("canvas");e.width=a;e.height=b;var f=e.getContext("2d");f.fillRect(4,0,a-8,b);f.fillRect(0,4,a,b-8);d?(f.arc(4,b-4,4,0,7),f.arc(a-4,b-4,4,0,7)):f.fillRect(0,b-8,a,b);c?(f.arc(4,4,4,0,7),f.arc(a-4,4,4,0,7)):f.fillRect(0,0,a,8);f.fill();return"url("+e.toDataURL()+")"};
Presenter.prototype.setPresenterInfo=function(){var a=this.ref;a.children(".presenter_name").text(this.name);a.children(".presenter_title").text(this.title);a=a.children(".presenter_link");this.bioHtml?(a.text(Frame.current.getTextLabel(this.email?"more_info":"bio")),a.attr("href","javascript:void(null)")):this.email?(a.text(Frame.current.getTextLabel("send_an_email")),a.attr("href","mailto:"+this.email),a.attr("target","_blank")):a.hide()};
Presenter.clearPresenters=function(){$(".logo_background .presenter_info").remove();$(".logo_background video").remove()};Presenter.prototype.show=function(){var a=this;Presenter.clearPresenters();$(".logo_background>.presenter_section").append(this.ref);this.video&&$(".logo_background>.presenter_video_section").append(this.video);this.ref.children(".presenter_link").unbind("click");this.bioHtml&&this.ref.children(".presenter_link").bind("click",function(){a.showDetail()});this.video&&this.video.get(0).play()};
Presenter.prototype.showDetail=function(){var a=this,b=$(".presenterInterstitial");0==b.length&&(b=$("<div class='presenterInterstitial'></div>"),player.container.prepend(b));if(!this.constructedCard){if(Frame.current.rtl)this.bioHtml=this.bioHtml.replace(/align='left'/ig,"align='right'");a.card=$("<div class='presenter_detail scrollarea vertical'><span class='presenter_bio'/><a class='presenter_mail'/><a class='presenter_close'/><canvas class='presenter_closebutton' width=26 height=26/></div>");
a.card.children(".presenter_bio").html(this.bioHtml);a.card.children(".presenter_mail").text(Frame.current.getTextLabel("send_an_email"));a.card.children(".presenter_mail").attr("href","mailto:"+a.email);a.card.children(".presenter_mail").attr("target","_blank");a.card.children(".presenter_close").text(Frame.current.getTextLabel("close"));a.card.children(".presenter_close").attr("href","javascript:void(null)");player.container.prepend(a.card);a.email||a.card.children(".presenter_mail").hide();var c=
a.card.children(".presenter_closebutton").get(0).getContext("2d");c.lineCap="round";var d=c.createLinearGradient(0,0,0,26);d.addColorStop(0,"#f99");d.addColorStop(1,"#933");c.fillStyle="#f00";c.strokeStyle=d;c.lineWidth=1;c.arc(13,13,12,0,2*Math.PI);c.fill();c.stroke();c.beginPath();c.strokeStyle="#fff";c.lineWidth=2;c.moveTo(9,9);c.lineTo(17,17);c.moveTo(17,9);c.lineTo(9,17);c.stroke();a.card.children(".presenter_close,.presenter_closebutton").bind("click",function(){MouseEvents.processHideables()});
MouseEvents.addHideable(".presenter_detail",".presenter_link,.presenter_detail",function(){a.card.hide();b.hide()});a.constructedCard=!0}this.card.show();b.unbind();b.show()};Presenter.prototype.videoPrepared=function(){return player.isMobile?player.nextPreparedClipID==this.videoUniqueKey&&Video.prepList[this.videoUniqueKey]:!0};
Presenter.prototype.tick=function(a){if(this.isVideo&&this.ref){var b=this.video.get(0);a.getIsPlaying()?this.videoPrepared()&&b.paused&&!b.ended&&b.play():!b.paused&&!b.ended&&b.pause();if(0.2<Math.abs(b.currentTime-a.getCurrentTime()/1E3))try{b.currentTime=a.getCurrentTime()/1E3}catch(c){}}};var TimerComponent=function(a){this.container=a||$(document.body);this.ref=null;this.content={fontsize:18,font:"Arial"};this.startPosition=0;this.startTime=null;this.currentPosition=0;this.running=!1};TimerComponent.prototype.show=function(){this.createRef();this.render();this.ref.show()};TimerComponent.prototype.hide=function(){this.ref.hide()};
TimerComponent.prototype.createRef=function(){if(this.ref)return!1;this.ref=$("<div class='timercaption'></div><canvas class='timer' width='20' height='20'></canvas>");this.captionRef=$(this.ref.get(0));this.canvasRef=$(this.ref.get(1));$("#framewrap").append(this.ref);this.context=this.canvasRef.get(0).getContext("2d");return!0};
TimerComponent.FormatMS=function(a,b){function c(a){return(a+100+"").substr(1)}var d=Math.floor(a/1E3%60),e=Math.floor(a/1E3/60%60),f=Math.floor(a/1E3/60/60);return 0<f?f+":"+c(e)+":"+c(d):b?e+":"+c(d):c(e)+":"+c(d)};TimerComponent.Format=function(a,b,c,d){switch(c){case "remaining":return TimerComponent.FormatMS(b-a);case "totalelapsed":return d?TimerComponent.FormatMS(b)+" / "+TimerComponent.FormatMS(a):TimerComponent.FormatMS(a)+" / "+TimerComponent.FormatMS(b);case "elapsed":return TimerComponent.FormatMS(a)}return""};
TimerComponent.prototype.updateText=function(){this.captionRef.html(TimerComponent.Format(this.currentPosition,this.duration,Frame.current.options.time_format))};
TimerComponent.prototype.render=function(){if(this.context){this.updateText();this.context.clearRect(0,0,20,20);this.context.strokeStyle="#cfcfcf";this.context.fillStyle="#fff";this.context.lineWidth=1;if(!player.isMobileFrame)this.context.strokeStyle=Frame.current.colorGroups.timer.stroke.toColorString();this.context.beginPath();this.context.arc(10,10,9.5,0,2*Math.PI,!1);this.context.fill();this.context.stroke();this.context.lineWidth=1;var a=this.context.createLinearGradient(0,0,0,20);a.addColorStop(0,
"#039EF4");a.addColorStop(1,"#0147E6");var b=this.context.createLinearGradient(0,0,0,20);b.addColorStop(0,"#FDE145");b.addColorStop(1,"#E4B202");player.isMobileFrame||(a=Frame.current.colorGroups.timer.duration.toCanvasGradient(this.context,20),b=Frame.current.colorGroups.timer.elapsed.toCanvasGradient(this.context,20));var c=-Math.PI/2,d=c-2*this.currentPosition/this.duration*Math.PI;this.context.beginPath();this.context.fillStyle=a;this.context.moveTo(10,10);this.context.arc(10,10,8,d,c,!0);this.context.fill();
this.context.beginPath();this.context.fillStyle=b;this.context.moveTo(10,10);this.context.arc(10,10,8,c,d,!0);this.context.closePath();this.context.fill()}};var WindowComponent=function(a){this.container=a||WindowComponent.externalContainer;this.ref=null;this.linkid="";this.height=this.width=100;this.valign=this.align="center";this.isPrompt=!0};WindowComponent.externalContainer=$("#windowcontainer");
WindowComponent.prototype.loadFromXML=function(a){this.id=$(a).attr("id");this.linkid=$(a).attr("linkid");this.width=parseInt($(a).attr("width"))-2;this.height=parseInt($(a).attr("height"))-2;this.alignto=$(a).attr("alignto");this.align=$(a).attr("align");this.valign=$(a).attr("valign");-1<this.linkid.indexOf("StoryPopup")?(this.width-=6,this.height-=6,this.isPrompt=!1,this.isLightbox=!0):(this.isPrompt=!0,this.isLightbox=!1);if(-1<this.linkid.indexOf("Controls"))this.hasControls=!0;this.originalWidth=
this.width;this.originalHeight=this.height;this.hasControls=-1<this.linkid.indexOf("Controls")};
WindowComponent.prototype.show=function(){this.createRef();this.applySize();this.ref.show();this.visible=!0;if(-1<this.linkid.indexOf("StoryWindow")){if(!Frame.windowBlocker)Frame.windowBlocker=$("<div class='blocker'></div>"),$(".contentpane").append(Frame.windowBlocker);Frame.windowBlocker.show()}if(this.anyLightboxVisible()){WindowComponent.externalContainer.append($(".window.prompt"));var a=$(".frameInterstitial");a.addClass("dark");a.show()}this.isPrompt||WindowComponent.externalContainer.show();
Frame.current.currentWindow=this;Frame.current.raiseBoundsChanged()};WindowComponent.prototype.hide=function(){this.ref.hide();this.visible=!1;Frame.current.currentWindow=null;this.anyVisible()||($(".blocker").hide(),$(".interstitial").hide(),$(".frameInterstitial").hide(),$(".frameInterstitial").removeClass("dark"),$(".interstitial").removeClass("black"),player.container.append($(".window.prompt")),WindowComponent.externalContainer.hide());this.isPrompt||WindowComponent.externalContainer.hide()};
WindowComponent.prototype.anyVisible=function(){for(var a in Frame.current.windows)if(Frame.current.windows[a].visible)return!0;return!1};WindowComponent.prototype.anyLightboxVisible=function(){for(var a in Frame.current.windows)if(Frame.current.windows[a].visible&&Frame.current.windows[a].isLightbox)return!0;return!1};
WindowComponent.prototype.createRef=function(){if(this.ref)return!1;this.ref=$("<div class='window'><h1>Title</h1><hr><div class='windowContent'></div></div>");this.ref.addClass(this.id);this.contentRef=this.ref.children("div").first();this.titleRef=this.ref.children("h1").first();this.isPrompt&&this.ref.addClass("prompt");$("#slidecontainer").append(this.ref);this.ref.hide();this.isLightbox&&this.prepareLightbox();this.hasControls&&this.prepareControls();return!0};
WindowComponent.prototype.applySize=function(){this.isLightbox||$("#slidecontainer").append(this.ref);if(1!=Frame.current.frameScale&&!this.isPrompt)this.width=this.originalWidth*Frame.current.frameScale,this.height=this.originalHeight*Frame.current.frameScale;this.ref.css("width",this.width);this.ref.css("height",this.height);this.ref.css("margin","auto");switch(this.align){case "center":this.ref.css("left","50%");this.ref.css("margin-left",-this.width/2);break;default:console.log("unknown window align",
this.align)}switch(this.valign){case "center":this.ref.css("top","50%");this.ref.css("margin-top",-this.height/2);break;default:console.log("unknown window valign",this.valign)}this.isLightbox&&(this.contentRef.css("width",this.width),this.contentRef.css("height",this.height),this.closeIcon.css("left",(0.85*player.width-10)*Frame.current.frameScale+"px"));this.controls&&(this.controls.css("left","0px"),this.controls.css("width",player.width-10/Frame.current.frameScale),this.controls.css("margin-top",
Math.ceil(-33*Frame.current.frameScale)+"px"),this.ref.append(this.controls),this.controls.css("-webkit-transform-origin","top left"),this.controls.css("transform-origin","top left"),this.controls.css("-webkit-transform","translate3d(0px,0px,0px) scale("+0.85*Frame.current.frameScale+")"),this.controls.css("transform","translate3d(0px,0px,0px) scale("+0.85*Frame.current.frameScale+")"))};
WindowComponent.prototype.prepareLightbox=function(){var a=$(".frameInterstitial");0==a.length&&(a=$("<div class='frameInterstitial'></div>"),$("#framewrap").prepend(a));WindowComponent.externalContainer.append($(".window.prompt"));if(!this.lightboxPrepared){WindowComponent.externalContainer.append(this.ref);this.ref.addClass("lightbox");this.closeIcon=$("<div class='closeicon control-close_btn'><span>x</span></div>");this.ref.append(this.closeIcon);var b=this;this.closeIcon.click(function(){Frame.current.raiseCloseWindow(b.id)});
this.lightboxPrepared=!0}};
WindowComponent.prototype.prepareControls=function(){if(!(0<this.ref.find(".contentpane>#controls").length))this.controls=$(".contentpane>#controls").clone(!1),this.controls.css("left","0px"),this.controls.css("width",(this.width-10)/0.85*Frame.current.frameScale),this.ref.append(this.controls),this.controls.show(),this.controls.find(".play").bind("click",function(){player.timelineManager.playActiveTimeline()}),this.controls.find(".pause").bind("click",function(){player.timelineManager.pauseActiveTimeline()}),this.volumeSlider=
new VolumeSlider(this.controls.find(".control-volume")),this.volumeSlider.onDragUpdate=function(a){$("audio,video").each(function(b,c){c.volume=Math.min(a*player.clipVolume,1)});Audio.setMasterVolume&&Audio.setMasterVolume(a);VolumeSlider.updateVolumeIcon(a)}};WindowComponent.prototype.isExternal=function(){return this.ref&&this.ref[0].offsetParent&&this.ref[0].offsetParent.id==WindowComponent.externalContainer[0].id};function CustomStyleSheet(){this.rules=[];this.ruleLookup={};this.sheet=null}CustomStyleSheet.prototype.add=function(a,b,c){if(this.ruleLookup[a])this.ruleLookup[a].add(b,c);else{var d=new StyleRule(a);d.add(b,c);this.ruleLookup[a]=d;this.rules.push(d)}};CustomStyleSheet.prototype.build=function(){if(!this.sheet)this.sheet=document.createElement("style"),document.body.appendChild(this.sheet);var a="";$.each(this.rules,function(b,c){a+=c.toString()+"\r\n\r\n"});this.sheet.innerHTML=a};function StyleRule(a){this.selector=a;this.attributes=[]}StyleRule.prototype.add=function(a,b){this.attributes.push({name:a,value:b})};StyleRule.prototype.toString=function(){var a=this.selector+"\r\n{\r\n";$.each(this.attributes,function(b,c){a+="\t"+c.name+": "+c.value+";\r\n"});return a+="}\r\n\r\n"};player.isFramed=top!=self;player.isFramedOffset=!1;player.hasNavOutsideFrame=!1;if(player.isFramed){var myFrame=Frame.findCurrentFrame();if(myFrame)player.isFramedOffset=0<myFrame.offsetWidth||0<myFrame.offsetHeight}
if(player.isMobile||-1<location.search.indexOf("mobile=1"))player.scaleWithTransform=!0,Frame.requestFullScreen=function(){var a=document.documentElement,b=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen;if(b){b.call(a);var c=window.innerHeight;if(!Frame.fullScreenInterval)Frame.fullScreenInterval=setInterval(function(){var a=window.innerHeight;if(a!=c){var b=FrameKit.isPortrait();Frame.current.initOrientation(b,!b);Frame.current.updateFrame();Frame.current.raiseBoundsChanged()}c=
a},300);return!0}return!1},Frame.exitFullScreen=function(a){var b=document,c=b.exitFullScreen||b.webkitExitFullScreen||b.webkitExitFullscreen||b.mozExitFullScreen;if(c&&(c.call(b),(Frame.enterFullScreenOnTouch=a)&&!Frame.hasReEnterFullScreenWatcher))Frame.hasReEnterFullScreenWatcher=!0,$(document.body).bind("touchstart",function(){"webkitIsFullScreen"in document&&document.webkitIsFullScreen||Frame.requestFullScreen()})},player.iosFrameTop=0,player.iosFrameLeft=0,DefaultFrame.prototype.initOrientation=
function(a,b){var c=FrameKit.isPortrait();window.scrollTo(player.iosFrameTop,player.iosFrameLeft);if(self!=top&&!player.isCrossDomainFrame)if(c&&$(document.body).addClass("portrait"),player.hasNavOutsideFrame=window.innerHeight!=top.window.innerHeight||window.innerWidth!=top.window.innerWidth,player.hasNavOutsideFrame){player.scaleToFit=!0;var d=document.createElement("meta");d.setAttribute("id","viewport");d.setAttribute("name","viewport");d.setAttribute("content","width=device-width, user-scalable=yes");
document.getElementsByTagName("head")[0].appendChild(d);player.getMyFrame=function(){var a=top.document.getElementsByTagName("iframe"),b=window.frameElement;if(!b){for(var c=0;c<a.length;c++)-1<a[c].src.indexOf("index_lms_html5")&&(b=a[c]);!b&&0<a.length&&(b=a[0])}return b};player.walkToTop=function(a,b){var c=a,d=self;do{do b(c);while(c=c.offsetParent||c.parentNode||c.frameElement);c=d=d.parent}while(d!=top);return a};player.updateFrameOffset=function(){var a=player.getMyFrame();if(a){var b=parseInt(a.style.left),
c=parseInt(a.style.top);if(isNaN(b)||isNaN(c))c=b=0;player.walkToTop(a,function(a){b+=a.offsetLeft||0;c+=a.offsetTop||0});player.iosFrameTop=c;player.iosFrameLeft=b}return a};player.popMyFrame=function(){var a=player.updateFrameOffset();if(!player.hasPoppedOut)player.hasPoppedOut=!0,a.style.position="absolute",a.style.left=player.iosFrameLeft+"px",a.style.top=player.iosFrameTop+"px",setTimeout(function(){console.log("scrolling",player.iosFrameLeft,player.iosFrameTop,a.style.left,a.style.top);player.updateFrameOffset();
top.window.scrollTo(player.iosFrameLeft,player.iosFrameTop);console.log("scrolled",player.iosFrameLeft,player.iosFrameTop,a.style.left,a.style.top)},1E3),console.log("popping",player.iosFrameLeft,player.iosFrameTop,a.style.left,a.style.top),setTimeout(function(){top.document.body.appendChild(a);console.log("popped",player.iosFrameLeft,player.iosFrameTop,a.style.left,a.style.top)},0),top.window.scrollTo(player.iosFrameLeft,player.iosFrameTop);return a};player.fitToFrameContainer=function(){var a=function(a){return a.innerWidth||
a.clientWidth||a.style&&!isNaN(parseInt(a.style.width))&&parseInt(a.style.width)||a.width||0},b=function(a){return a.innerHeight||a.clientHeight||a.style&&!isNaN(parseInt(a.style.height))&&parseInt(a.style.height)||a.height||0},c=player.getMyFrame(),d=a(c),e=b(c);player.walkToTop(c,function(c){var f=a(c),c=b(c);f&&c&&(d=Math.min(d,f),e=Math.min(e,c))});window.innerWidth=d;window.innerHeight=e;Frame.current.updateFrameLayout()};player.fitToFrameContainer()}else top.window.scrollTo(player.iosFrameLeft,
player.iosFrameTop);else if(player.isCrossDomainFrame&&player.isIOS&&!player.isIOSlt8)player.hasNavOutsideFrame=!0,Frame.current.updateFrameLayout();window.scrollTo(0,0);if(!player.hasNavOutsideFrame){var d=DefaultFrame.getWindowSize(!0),e=d.width,f=d.height,g=c?f:e,h=c?e:f,d=c?e:f,e=c?f:e,k=story.frameWidth-2,i=story.frameHeight-2;this.containerWidth=k;this.containerHeight=i;$("#framewrap").css("width",k);$("#framewrap").css("height",i);var j=window.screen.width,l=window.screen.height;if(!player.isAndroid&&
!c)j=window.screen.height,l=window.screen.width;f=l-f;c?(e=l-f,d=j,h=j-f,g=l):(h=l-f,g=j,e=j-f,d=l);f=g/h;j=k/i;c=1;if(!a)this.landscapeWidth=g,this.landscapeHeight=h,c=j>f?g/k:h/i,this.aspectRatio=k/i,f=parseInt((h-i*c)/2-1),0>f&&(f=0),j=parseInt((g-k*c)/2-1),0>j&&(j=0),this.containerLeftLandscape=j,this.containerTopLandscape=f,j="top:"+f+"px!important; left:"+j+"px!important;",f=0.5*Math.min(h,g),g="#framewrap{-webkit-transform-origin:top left;-webkit-transform:translate3d(0px,0px,0px) scale("+
c+");width:"+k+"px;height:"+i+"px;"+j+".interstitial{height:"+h+"px;width:"+g+"px;}}"+("div.launch_interstitial>a{width:"+f+"px;height:"+f+"px;margin-left:"+-f/2+"px;margin-top:"+-f/2+"px;"),player.landscapeFrameScale=c,player.frameLandscapeStyleSheet=document.createElement("style"),player.frameLandscapeStyleSheet.media=player.isIOS?"only screen and (max-device-width: 1024px) and (orientation:landscape)":"only screen and (orientation:landscape)",player.frameLandscapeStyleSheet.innerHTML=g,document.body.appendChild(player.frameLandscapeStyleSheet);
if(!b&&(this.portraitWidth=d,this.portraitHeight=e,c=1,c=k/i>d/e?d/k:e/i,f=parseInt((e-i*c)/2-1),0>f&&(f=0),j=parseInt((d-k*c)/2-1),0>j&&(j=0),this.containerLeftPortrait=j,this.containerTopPortrait=f,g="top:"+f+"px!important; left:"+j+"px!important;",f=0.5*Math.min(e,d),d="#framewrap{-webkit-transform-origin:top left;-moz-transform-origin:top left;-ms-transform-origin:top left;-webkit-transform:translate3d(0px,0px,0px) scale("+c+");-moz-transform:translate3d(0px,0px,0px) scale("+c+");-ms-transform:translate(0px,0px) scale("+
c+");width:"+k+"px;height:"+i+"px;"+g+".interstitial{height:"+e+"px;width:"+d+"px;}}"+("div.launch_interstitial>a{width:"+f+"px;height:"+f+"px;margin-left:"+-f/2+"px;margin-top:"+-f/2+"px;"),player.rotatePortraitStyleSheet=document.createElement("style"),player.rotatePortraitStyleSheet.media=player.isIOS?"only screen and (max-device-width: 1024px) and (orientation:portrait)":"only screen and (orientation:portrait)",player.rotatePortraitStyleSheet.innerHTML=d,document.body.appendChild(player.rotatePortraitStyleSheet),
player.portraitFrameScale=c,self!=top))d=d.replace("framewrap","portrait #framewrap").replace("interstitial","portrait .interstitial"),player.rotatePortraitFramedStyleSheet=document.createElement("style"),player.rotatePortraitFramedStyleSheet.innerHTML=d,document.body.appendChild(player.rotatePortraitFramedStyleSheet);setTimeout(function(){player.currentSlide()&&player.currentSlide().ref&&player.currentSlide().fitToContainer()},0)}},DefaultFrame.prototype.reInitIfNecessary=function(){if(!player.hasNavOutsideFrame){var a=
FrameKit.isPortrait(),b=window.innerHeight,c,d,e;player.isCrossDomainFrame||(b=Math.min(window.innerHeight,top.window.innerHeight));var f=window.screen.width,g=window.screen.height;if(!player.isAndroid&&!a)f=window.screen.height,g=window.screen.width;var h=g-b;a?(e=g-h,d=f,c=f-h,b=g):(c=g-h,b=f,e=f-h,d=g);a&&(this.portraitWidth!=d||this.portraitHeight!=e)&&Frame.current.initOrientation(!0,!1);!a&&(this.landscapeWidth!=b||this.landscapeHeight!=c)&&Frame.current.initOrientation(!1,!0)}},DefaultFrame.prototype.updateFrame=
function(a){player.hasNavOutsideFrame&&player.fitToFrameContainer&&player.fitToFrameContainer();DefaultFrame.resizeSpinners();if(1!=player.width){var b=DefaultFrame.getDeviceOrientation();if(a||b!=player.lastOrientation&&!Frame.current.reorientTimeout){Frame.current.reorientTimeout=setTimeout(function(){clearTimeout(Frame.current.reorientTimeout);Frame.current.reorientTimeout=null;Frame.current.reInitIfNecessary()},300);window.scrollTo(0,0);if(!player.isCrossDomainFrame&&(player.hasPoppedOut||!player.hasNavOutsideFrame))player.updateFrameOffset&&
player.updateFrameOffset(),top.window.scrollTo(player.iosFrameLeft,player.iosFrameTop);!player.hasNavOutsideFrame&&player.portraitFrameScale&&!isNaN(player.portraitFrameScale)&&player.landscapeFrameScale&&!isNaN(player.landscapeFrameScale)?FrameKit.isPortrait()?(this.frameScale=player.frameScale=player.portraitFrameScale,Frame.current.containerLeft=Frame.current.containerLeftPortrait,Frame.current.containerTop=Frame.current.containerTopPortrait,$(document.body).addClass("portrait")):(this.frameScale=
player.frameScale=player.landscapeFrameScale,Frame.current.containerLeft=Frame.current.containerLeftLandscape,Frame.current.containerTop=Frame.current.containerTopLandscape,$(document.body).removeClass("portrait")):$(document.body).removeClass("portrait");player.currentZoomImage&&(player.currentZoomImage.zoomedImage.css("-webkit-transition-property",""),player.currentZoomImage.zoomedImage.css("-webkit-transition-duration","0"),player.currentZoomImage.zoomedImage.css("-moz-transition-property",""),
player.currentZoomImage.zoomedImage.css("-moz-transition-duration","0"),player.currentZoomImage.zoomedImage.css("-ms-transition-property",""),player.currentZoomImage.zoomedImage.css("-ms-transition-duration","0"),player.currentZoomImage.setZoomedCSS(player.currentZoomImage.zoomedImage));player.lastOrientation=b}$.each(story.children,function(a,b){"Window"==b.innerType&&b.resize()})}},DefaultFrame.prototype.prepLaunchButton=function(){var a=document.createElement("canvas");a.width=400;a.height=400;
var b=a.getContext("2d");b.translate(200,200);b.beginPath();b.arc(0,0,198,0,2*Math.PI);b.fillStyle="#ddd";b.fill();var c=b.createLinearGradient(0,-200,0,200);c.addColorStop(0,"#444");c.addColorStop(1,"#000");b.beginPath();b.arc(0,0,193,0,2*Math.PI);b.fillStyle=c;b.fill();b.save();b.beginPath();b.moveTo(140,0);b.rotate(2*Math.PI/3);b.lineTo(140,0);b.rotate(2*Math.PI/3);b.lineTo(140,0);b.closePath();b.fillStyle="#bbb";b.fill();b.restore();a=a.toDataURL();$(".launch_interstitial>a").css("background-image",
"url("+a+")")},DefaultFrame.prototype.showMobileInterstitial=function(a){player.launch=$('<div class="launch_interstitial"><a></a></div>');$(document.body).prepend(player.launch);this.prepLaunchButton();player.launch.show();player.launch.bind(player.isDesktop?"mousedown":"touchstart",function(b){player.launch.hide();a(b);b.stopPropagation()});if(500>window.innerWidth||player.isIPhone){var b=player.launch.find(".container"),c=function(){var a=player.isCrossDomainFrame?window.orientation:top.window.orientation,
c=FrameKit.isPortrait();if(a!=player.lastLaunchOrientation||window.innerWidth!=player.lastLaunchWidth||window.innerHeight!=player.lastLaunchHeight)player.lastLaunchOrientation=a,player.lastLaunchWidth=window.innerWidth,player.lastLaunchHeight=window.innerHeight,a=1/player.launch.css("zoom"),c?(b.css("width",(window.innerWidth-100)*a+"px"),b.css("height",(window.innerHeight-100)*a+"px")):(b.css("width",(window.innerWidth-80)*a+"px"),b.css("height",(window.innerHeight-80)*a+"px"),b.css("margin","40px"))};
player.reorientLaunchInterval=setInterval(function(){c()},100);window.addEventListener("orientationchange",c);c()}};
